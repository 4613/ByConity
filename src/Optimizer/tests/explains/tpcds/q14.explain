Projection est. 100 rows
│     Expressions: channel:=`expr#'store'_1`, i_brand_id:=i_brand_id_9, i_category_id:=i_category_id_9, i_class_id:=i_class_id_9, sum(number_sales):=`expr#sum(number_sales)`, sum(sales):=`expr#sum(sales)`
└─ Limit est. 100 rows
   │     Limit: 100
   └─ Sorting est. ? rows
      │     Order by: {expr#'store'_1 asc, i_brand_id_9 asc, i_class_id_9 asc, i_category_id_9 asc}
      │     Limit: 100
      └─ Gather Exchange est. ? rows
         └─ Sorting est. ? rows
            │     Order by: {expr#'store'_1 asc, i_brand_id_9 asc, i_class_id_9 asc, i_category_id_9 asc}
            │     Limit: 100
            └─ Aggregating est. ? rows
               │     Group by: {expr#'store'_1, i_brand_id_9, i_category_id_9, i_class_id_9}
               │     Aggregates: expr#sum(sales):=AggNull(sum)(expr#sum(multiply(ss_quantity, ss_list_price))_1), expr#sum(number_sales):=AggNull(sum)(expr#count()_3)
               └─ Union est. ? rows
                  ├─ Projection est. ? rows
                  │  │     Expressions: [expr#count(), expr#sum(multiply(ss_quantity, ss_list_price)), i_brand_id, i_category_id, i_class_id], expr#'store':='store'
                  │  └─ Inner Join est. ? rows
                  │     │     Condition: 
                  │     │     Filter: `expr#sum(multiply(ss_quantity, ss_list_price))` > `expr#avg(multiply(quantity, list_price))_1`
                  │     ├─ MergingAggregated est. 152480 rows
                  │     │  └─ Repartition Exchange est. 152480 rows
                  │     │     │     Partition by: {i_brand_id, i_category_id, i_class_id}
                  │     │     └─ Aggregating est. 152480 rows
                  │     │        │     Group by: {i_brand_id, i_category_id, i_class_id}
                  │     │        │     Aggregates: expr#sum(multiply(ss_quantity, ss_list_price)):=AggNull(sum)(expr#multiply(ss_quantity, ss_list_price)), expr#count():=AggNull(count)()
                  │     │        └─ Projection est. 45121367 rows
                  │     │           │     Expressions: [i_brand_id, i_category_id, i_class_id], expr#multiply(ss_quantity, ss_list_price):=ss_quantity * ss_list_price
                  │     │           └─ Inner Join est. 40609124 rows
                  │     │              │     Condition: ss_item_sk == i_item_sk
                  │     │              ├─ Repartition Exchange est. 45121367 rows
                  │     │              │  │     Partition by: {ss_item_sk}
                  │     │              │  └─ Inner Join est. 45121367 rows
                  │     │              │     │     Condition: ss_sold_date_sk == d_date_sk
                  │     │              │     ├─ Local Exchange est. 2879987999 rows
                  │     │              │     │  └─ Filter est. 2879987999 rows
                  │     │              │     │     │     Condition: isNotNull(ss_item_sk)
                  │     │              │     │     │     Dynamic Filters: {ss_sold_date_sk:bloomfilter,ss_sold_date_sk:range}
                  │     │              │     │     └─ TableScan tpcds.store_sales est. 2879987999 rows
                  │     │              │     │              Outputs: [ss_item_sk, ss_list_price, ss_quantity, ss_sold_date_sk]
                  │     │              │     └─ Broadcast Exchange est. 29 rows
                  │     │              │        └─ Projection est. 29 rows
                  │     │              │           │     Expressions: [d_date_sk, d_moy, d_year]
                  │     │              │           │     Dynamic Filters Builder: {d_date_sk}
                  │     │              │           └─ Filter est. 29 rows
                  │     │              │              │     Condition: (d_moy = 11) AND (d_year = 2001)
                  │     │              │              └─ TableScan tpcds.date_dim est. 73049 rows
                  │     │              │                       Outputs: [d_date_sk, d_moy, d_year]
                  │     │              └─ Inner Join est. 269999 rows
                  │     │                 │     Condition: i_item_sk == i_item_sk_5
                  │     │                 ├─ Repartition Exchange est. 300000 rows
                  │     │                 │  │     Partition by: {i_item_sk}
                  │     │                 │  └─ Filter est. 300000 rows
                  │     │                 │     │     Condition: isNotNull(i_item_sk)
                  │     │                 │     └─ TableScan tpcds.item est. 300000 rows
                  │     │                 │              Outputs: [i_brand_id, i_category_id, i_class_id, i_item_sk]
                  │     │                 └─ Aggregating est. 269633 rows
                  │     │                    │     Group by: {i_item_sk_5}
                  │     │                    └─ Filter est. 388815110 rows
                  │     │                       │     Condition: isNotNull(i_item_sk_5)
                  │     │                       └─ CTERef [0] est. 432016789 rows
                  │     └─ Broadcast Exchange est. 1 rows
                  │        └─ EnforceSingleRow est. 1 rows
                  │           └─ CTERef [1] est. 1 rows
                  ├─ Projection est. ? rows
                  │  │     Expressions: [expr#count()_1, expr#sum(multiply(cs_quantity, cs_list_price)), i_brand_id_7, i_category_id_7, i_class_id_7], expr#'catalog':='catalog'
                  │  └─ Inner Join est. ? rows
                  │     │     Condition: 
                  │     │     Filter: `expr#sum(multiply(cs_quantity, cs_list_price))` > `expr#avg(multiply(quantity, list_price))_2`
                  │     ├─ MergingAggregated est. 152480 rows
                  │     │  └─ Repartition Exchange est. 152480 rows
                  │     │     │     Partition by: {i_brand_id_7, i_category_id_7, i_class_id_7}
                  │     │     └─ Aggregating est. 152480 rows
                  │     │        │     Group by: {i_brand_id_7, i_category_id_7, i_class_id_7}
                  │     │        │     Aggregates: expr#sum(multiply(cs_quantity, cs_list_price)):=AggNull(sum)(expr#multiply(cs_quantity, cs_list_price)), expr#count()_1:=AggNull(count)()
                  │     │        └─ Projection est. 22415154 rows
                  │     │           │     Expressions: [i_brand_id_7, i_category_id_7, i_class_id_7], expr#multiply(cs_quantity, cs_list_price):=cs_quantity_2 * cs_list_price_2
                  │     │           └─ Inner Join est. 20173586 rows
                  │     │              │     Condition: cs_item_sk_2 == i_item_sk_6
                  │     │              ├─ Repartition Exchange est. 22415154 rows
                  │     │              │  │     Partition by: {cs_item_sk_2}
                  │     │              │  └─ Inner Join est. 22415154 rows
                  │     │              │     │     Condition: cs_sold_date_sk_2 == d_date_sk_7
                  │     │              │     ├─ Local Exchange est. 1439980416 rows
                  │     │              │     │  └─ Filter est. 1439980416 rows
                  │     │              │     │     │     Condition: isNotNull(cs_item_sk_2)
                  │     │              │     │     │     Dynamic Filters: {cs_sold_date_sk_2:bloomfilter,cs_sold_date_sk_2:range}
                  │     │              │     │     └─ TableScan tpcds.catalog_sales est. 1439980416 rows
                  │     │              │     │              Outputs: cs_item_sk_2:=cs_item_sk, cs_list_price_2:=cs_list_price, cs_quantity_2:=cs_quantity, cs_sold_date_sk_2:=cs_sold_date_sk
                  │     │              │     └─ Broadcast Exchange est. 29 rows
                  │     │              │        └─ Projection est. 29 rows
                  │     │              │           │     Expressions: [d_date_sk_7, d_moy_7, d_year_7]
                  │     │              │           │     Dynamic Filters Builder: {d_date_sk_7}
                  │     │              │           └─ Filter est. 29 rows
                  │     │              │              │     Condition: (d_year_7 = 2001) AND (d_moy_7 = 11)
                  │     │              │              └─ TableScan tpcds.date_dim est. 73049 rows
                  │     │              │                       Outputs: d_date_sk_7:=d_date_sk, d_moy_7:=d_moy, d_year_7:=d_year
                  │     │              └─ Inner Join est. 269999 rows
                  │     │                 │     Condition: i_item_sk_6 == i_item_sk_7
                  │     │                 ├─ Repartition Exchange est. 300000 rows
                  │     │                 │  │     Partition by: {i_item_sk_6}
                  │     │                 │  └─ Filter est. 300000 rows
                  │     │                 │     │     Condition: isNotNull(i_item_sk_6)
                  │     │                 │     └─ TableScan tpcds.item est. 300000 rows
                  │     │                 │              Outputs: i_brand_id_7:=i_brand_id, i_category_id_7:=i_category_id, i_class_id_7:=i_class_id, i_item_sk_6:=i_item_sk
                  │     │                 └─ Aggregating est. 269633 rows
                  │     │                    │     Group by: {i_item_sk_7}
                  │     │                    └─ Filter est. 388815110 rows
                  │     │                       │     Condition: isNotNull(i_item_sk_7)
                  │     │                       └─ CTERef [0] est. 432016789 rows
                  │     └─ Broadcast Exchange est. 1 rows
                  │        └─ EnforceSingleRow est. 1 rows
                  │           └─ CTERef [1] est. 1 rows
                  └─ Projection est. ? rows
                     │     Expressions: [expr#count()_2, expr#sum(multiply(ws_quantity, ws_list_price)), i_brand_id_8, i_category_id_8, i_class_id_8], expr#'web':='web'
                     └─ Inner Join est. ? rows
                        │     Condition: 
                        │     Filter: `expr#sum(multiply(ws_quantity, ws_list_price))` > `expr#avg(multiply(quantity, list_price))_3`
                        ├─ MergingAggregated est. 152480 rows
                        │  └─ Repartition Exchange est. 152480 rows
                        │     │     Partition by: {i_brand_id_8, i_category_id_8, i_class_id_8}
                        │     └─ Aggregating est. 152480 rows
                        │        │     Group by: {i_brand_id_8, i_category_id_8, i_class_id_8}
                        │        │     Aggregates: expr#sum(multiply(ws_quantity, ws_list_price)):=AggNull(sum)(expr#multiply(ws_quantity, ws_list_price)), expr#count()_2:=AggNull(count)()
                        │        └─ Projection est. 11280394 rows
                        │           │     Expressions: [i_brand_id_8, i_category_id_8, i_class_id_8], expr#multiply(ws_quantity, ws_list_price):=ws_quantity_2 * ws_list_price_2
                        │           └─ Inner Join est. 10152328 rows
                        │              │     Condition: ws_item_sk_2 == i_item_sk_8
                        │              ├─ Repartition Exchange est. 11280394 rows
                        │              │  │     Partition by: {ws_item_sk_2}
                        │              │  └─ Inner Join est. 11280394 rows
                        │              │     │     Condition: ws_sold_date_sk_2 == d_date_sk_8
                        │              │     ├─ Local Exchange est. 720000376 rows
                        │              │     │  └─ Filter est. 720000376 rows
                        │              │     │     │     Condition: isNotNull(ws_item_sk_2)
                        │              │     │     │     Dynamic Filters: {ws_sold_date_sk_2:bloomfilter,ws_sold_date_sk_2:range}
                        │              │     │     └─ TableScan tpcds.web_sales est. 720000376 rows
                        │              │     │              Outputs: ws_item_sk_2:=ws_item_sk, ws_list_price_2:=ws_list_price, ws_quantity_2:=ws_quantity, ws_sold_date_sk_2:=ws_sold_date_sk
                        │              │     └─ Broadcast Exchange est. 29 rows
                        │              │        └─ Projection est. 29 rows
                        │              │           │     Expressions: [d_date_sk_8, d_moy_8, d_year_8]
                        │              │           │     Dynamic Filters Builder: {d_date_sk_8}
                        │              │           └─ Filter est. 29 rows
                        │              │              │     Condition: (d_year_8 = 2001) AND (d_moy_8 = 11)
                        │              │              └─ TableScan tpcds.date_dim est. 73049 rows
                        │              │                       Outputs: d_date_sk_8:=d_date_sk, d_moy_8:=d_moy, d_year_8:=d_year
                        │              └─ Inner Join est. 269999 rows
                        │                 │     Condition: i_item_sk_8 == i_item_sk_9
                        │                 ├─ Repartition Exchange est. 300000 rows
                        │                 │  │     Partition by: {i_item_sk_8}
                        │                 │  └─ Filter est. 300000 rows
                        │                 │     │     Condition: isNotNull(i_item_sk_8)
                        │                 │     └─ TableScan tpcds.item est. 300000 rows
                        │                 │              Outputs: i_brand_id_8:=i_brand_id, i_category_id_8:=i_category_id, i_class_id_8:=i_class_id, i_item_sk_8:=i_item_sk
                        │                 └─ Aggregating est. 269633 rows
                        │                    │     Group by: {i_item_sk_9}
                        │                    └─ Filter est. 388815110 rows
                        │                       │     Condition: isNotNull(i_item_sk_9)
                        │                       └─ CTERef [0] est. 432016789 rows
                        └─ Broadcast Exchange est. 1 rows
                           └─ EnforceSingleRow est. 1 rows
                              └─ CTERef [1] est. 1 rows
CTEDef [1]
MergingAggregated est. 1 rows
└─ Gather Exchange est. 1 rows
   └─ Aggregating est. 1 rows
      │     Group by: {}
      │     Aggregates: expr#avg(multiply(quantity, list_price)):=AggNull(avg)(expr#multiply(quantity, list_price))
      └─ Projection est. 1489367945 rows
         │     Expressions: expr#multiply(quantity, list_price):=ss_quantity_3 * ss_list_price_3
         └─ Union est. 1489367945 rows
            ├─ Inner Join est. 852638262 rows
            │  │     Condition: ss_sold_date_sk_2 == d_date_sk_4
            │  ├─ Local Exchange est. 2879987999 rows
            │  │  └─ Filter est. 2879987999 rows
            │  │     │     Dynamic Filters: {ss_sold_date_sk_2:bloomfilter,ss_sold_date_sk_2:range}
            │  │     └─ TableScan tpcds.store_sales est. 2879987999 rows
            │  │              Outputs: ss_list_price_2:=ss_list_price, ss_quantity_2:=ss_quantity, ss_sold_date_sk_2:=ss_sold_date_sk
            │  └─ Broadcast Exchange est. 1096 rows
            │     └─ Projection est. 1096 rows
            │        │     Expressions: [d_date_sk_4, d_year_4]
            │        │     Dynamic Filters Builder: {d_date_sk_4}
            │        └─ Filter est. 1096 rows
            │           │     Condition: (d_year_4 >= 1999) AND (d_year_4 <= 2001)
            │           └─ TableScan tpcds.date_dim est. 73049 rows
            │                    Outputs: d_date_sk_4:=d_date_sk, d_year_4:=d_year
            ├─ Inner Join est. 423569118 rows
            │  │     Condition: cs_sold_date_sk_1 == d_date_sk_5
            │  ├─ Local Exchange est. 1439980416 rows
            │  │  └─ Filter est. 1439980416 rows
            │  │     │     Dynamic Filters: {cs_sold_date_sk_1:bloomfilter,cs_sold_date_sk_1:range}
            │  │     └─ TableScan tpcds.catalog_sales est. 1439980416 rows
            │  │              Outputs: cs_list_price_1:=cs_list_price, cs_quantity_1:=cs_quantity, cs_sold_date_sk_1:=cs_sold_date_sk
            │  └─ Broadcast Exchange est. 1096 rows
            │     └─ Projection est. 1096 rows
            │        │     Expressions: [d_date_sk_5, d_year_5]
            │        │     Dynamic Filters Builder: {d_date_sk_5}
            │        └─ Filter est. 1096 rows
            │           │     Condition: (d_year_5 <= 2001) AND (d_year_5 >= 1999)
            │           └─ TableScan tpcds.date_dim est. 73049 rows
            │                    Outputs: d_date_sk_5:=d_date_sk, d_year_5:=d_year
            └─ Inner Join est. 213160565 rows
               │     Condition: ws_sold_date_sk_1 == d_date_sk_6
               ├─ Local Exchange est. 720000376 rows
               │  └─ Filter est. 720000376 rows
               │     │     Dynamic Filters: {ws_sold_date_sk_1:bloomfilter,ws_sold_date_sk_1:range}
               │     └─ TableScan tpcds.web_sales est. 720000376 rows
               │              Outputs: ws_list_price_1:=ws_list_price, ws_quantity_1:=ws_quantity, ws_sold_date_sk_1:=ws_sold_date_sk
               └─ Broadcast Exchange est. 1096 rows
                  └─ Projection est. 1096 rows
                     │     Expressions: [d_date_sk_6, d_year_6]
                     │     Dynamic Filters Builder: {d_date_sk_6}
                     └─ Filter est. 1096 rows
                        │     Condition: (d_year_6 >= 1999) AND (d_year_6 <= 2001)
                        └─ TableScan tpcds.date_dim est. 73049 rows
                                 Outputs: d_date_sk_6:=d_date_sk, d_year_6:=d_year
CTEDef [0]
Repartition Exchange est. 432016789 rows
│     Partition by: {i_item_sk_1}
└─ Inner Join est. 432016789 rows
   │     Condition: i_brand_id_6 == i_brand_id_1, i_category_id_6 == i_category_id_1, i_class_id_6 == i_class_id_1
   ├─ Repartition Exchange est. 3705264 rows
   │  │     Partition by: {i_brand_id_6, i_category_id_6, i_class_id_6}
   │  └─ Filter est. 3705264 rows
   │     │     Condition: (count_1 >= 1) AND (count_2 >= 1) AND (count >= 1)
   │     └─ MergingAggregated est. 4116960 rows
   │        └─ Repartition Exchange est. 4116960 rows
   │           │     Partition by: {i_brand_id_6, i_category_id_6, i_class_id_6}
   │           └─ Aggregating est. 4116960 rows
   │              │     Group by: {i_brand_id_6, i_category_id_6, i_class_id_6}
   │              │     Aggregates: count:=AggNull(sum)(marker), count_1:=AggNull(sum)(marker_1), count_2:=AggNull(sum)(marker_2)
   │              └─ Union est. 2978735891 rows
   │                 ├─ Projection est. 1705276524 rows
   │                 │  │     Expressions: [i_brand_id_2, i_category_id_2, i_class_id_2], marker_3:=1, marker_4:=0, marker_5:=0
   │                 │  └─ Inner Join est. 852638262 rows
   │                 │     │     Condition: ss_item_sk_1 == i_item_sk_2
   │                 │     ├─ Repartition Exchange est. 852638262 rows
   │                 │     │  │     Partition by: {ss_item_sk_1}
   │                 │     │  └─ Inner Join est. 852638262 rows
   │                 │     │     │     Condition: ss_sold_date_sk_1 == d_date_sk_1
   │                 │     │     ├─ Local Exchange est. 2879987999 rows
   │                 │     │     │  └─ Filter est. 2879987999 rows
   │                 │     │     │     │     Dynamic Filters: {ss_sold_date_sk_1:bloomfilter,ss_sold_date_sk_1:range}
   │                 │     │     │     └─ TableScan tpcds.store_sales est. 2879987999 rows
   │                 │     │     │              Outputs: ss_item_sk_1:=ss_item_sk, ss_sold_date_sk_1:=ss_sold_date_sk
   │                 │     │     └─ Broadcast Exchange est. 1096 rows
   │                 │     │        └─ Projection est. 1096 rows
   │                 │     │           │     Expressions: [d_date_sk_1, d_year_1]
   │                 │     │           │     Dynamic Filters Builder: {d_date_sk_1}
   │                 │     │           └─ Filter est. 1096 rows
   │                 │     │              │     Condition: (d_year_1 <= 2001) AND (d_year_1 >= 1999)
   │                 │     │              └─ TableScan tpcds.date_dim est. 73049 rows
   │                 │     │                       Outputs: d_date_sk_1:=d_date_sk, d_year_1:=d_year
   │                 │     └─ Repartition Exchange est. 300000 rows
   │                 │        │     Partition by: {i_item_sk_2}
   │                 │        └─ TableScan tpcds.item est. 300000 rows
   │                 │                 Outputs: i_brand_id_2:=i_brand_id, i_category_id_2:=i_category_id, i_class_id_2:=i_class_id, i_item_sk_2:=i_item_sk
   │                 ├─ Projection est. 847138237 rows
   │                 │  │     Expressions: [i_brand_id_3, i_category_id_3, i_class_id_3], marker_6:=0, marker_7:=1, marker_8:=0
   │                 │  └─ Inner Join est. 423569118 rows
   │                 │     │     Condition: cs_item_sk == i_item_sk_3
   │                 │     ├─ Repartition Exchange est. 423569118 rows
   │                 │     │  │     Partition by: {cs_item_sk}
   │                 │     │  └─ Inner Join est. 423569118 rows
   │                 │     │     │     Condition: cs_sold_date_sk == d_date_sk_2
   │                 │     │     ├─ Local Exchange est. 1439980416 rows
   │                 │     │     │  └─ Filter est. 1439980416 rows
   │                 │     │     │     │     Dynamic Filters: {cs_sold_date_sk:bloomfilter,cs_sold_date_sk:range}
   │                 │     │     │     └─ TableScan tpcds.catalog_sales est. 1439980416 rows
   │                 │     │     │              Outputs: [cs_item_sk, cs_sold_date_sk]
   │                 │     │     └─ Broadcast Exchange est. 1096 rows
   │                 │     │        └─ Projection est. 1096 rows
   │                 │     │           │     Expressions: [d_date_sk_2, d_year_2]
   │                 │     │           │     Dynamic Filters Builder: {d_date_sk_2}
   │                 │     │           └─ Filter est. 1096 rows
   │                 │     │              │     Condition: (d_year_2 <= 2001) AND (d_year_2 >= 1999)
   │                 │     │              └─ TableScan tpcds.date_dim est. 73049 rows
   │                 │     │                       Outputs: d_date_sk_2:=d_date_sk, d_year_2:=d_year
   │                 │     └─ Repartition Exchange est. 300000 rows
   │                 │        │     Partition by: {i_item_sk_3}
   │                 │        └─ TableScan tpcds.item est. 300000 rows
   │                 │                 Outputs: i_brand_id_3:=i_brand_id, i_category_id_3:=i_category_id, i_class_id_3:=i_class_id, i_item_sk_3:=i_item_sk
   │                 └─ Projection est. 426321130 rows
   │                    │     Expressions: [i_brand_id_5, i_category_id_5, i_class_id_5], marker_10:=0, marker_11:=1, marker_9:=0
   │                    └─ Inner Join est. 213160565 rows
   │                       │     Condition: ws_item_sk == i_item_sk_4
   │                       ├─ Repartition Exchange est. 213160565 rows
   │                       │  │     Partition by: {ws_item_sk}
   │                       │  └─ Inner Join est. 213160565 rows
   │                       │     │     Condition: ws_sold_date_sk == d_date_sk_3
   │                       │     ├─ Local Exchange est. 720000376 rows
   │                       │     │  └─ Filter est. 720000376 rows
   │                       │     │     │     Dynamic Filters: {ws_sold_date_sk:bloomfilter,ws_sold_date_sk:range}
   │                       │     │     └─ TableScan tpcds.web_sales est. 720000376 rows
   │                       │     │              Outputs: [ws_item_sk, ws_sold_date_sk]
   │                       │     └─ Broadcast Exchange est. 1096 rows
   │                       │        └─ Projection est. 1096 rows
   │                       │           │     Expressions: [d_date_sk_3, d_year_3]
   │                       │           │     Dynamic Filters Builder: {d_date_sk_3}
   │                       │           └─ Filter est. 1096 rows
   │                       │              │     Condition: (d_year_3 <= 2001) AND (d_year_3 >= 1999)
   │                       │              └─ TableScan tpcds.date_dim est. 73049 rows
   │                       │                       Outputs: d_date_sk_3:=d_date_sk, d_year_3:=d_year
   │                       └─ Repartition Exchange est. 300000 rows
   │                          │     Partition by: {i_item_sk_4}
   │                          └─ TableScan tpcds.item est. 300000 rows
   │                                   Outputs: i_brand_id_5:=i_brand_id, i_category_id_5:=i_category_id, i_class_id_5:=i_class_id, i_item_sk_4:=i_item_sk
   └─ Repartition Exchange est. 300000 rows
      │     Partition by: {i_brand_id_1, i_category_id_1, i_class_id_1}
      └─ Filter est. 300000 rows
         │     Condition: isNotNull(i_item_sk_1)
         └─ TableScan tpcds.item est. 300000 rows
                  Outputs: i_brand_id_1:=i_brand_id, i_category_id_1:=i_category_id, i_class_id_1:=i_class_id, i_item_sk_1:=i_item_sk
note: Dynamic Filter is applied for 18 times.
note: CTE(Common Table Expression) is applied for 6 times.
Projection est. 100 rows
│     Expressions: ly_brand:=i_brand_id_92, ly_category:=i_category_id_92, ly_channel:=`expr#'store'_3`, ly_class:=i_class_id_92, ly_number_sales:=`expr#count()_5`, ly_sales:=`expr#sum(multiply(ss_quantity, ss_list_price))_3`, ty_brand:=i_brand_id_85, ty_category:=i_category_id_85, ty_channel:=`expr#'store'_2`, ty_class:=i_class_id_85, ty_number_sales:=`expr#count()_4`, ty_sales:=`expr#sum(multiply(ss_quantity, ss_list_price))_2`
└─ Limit est. 100 rows
   │     Limit: 100
   └─ Sorting est. ? rows
      │     Order by: {expr#'store'_2 asc, i_brand_id_85 asc, i_class_id_85 asc, i_category_id_85 asc}
      │     Limit: 100
      └─ Gather Exchange est. ? rows
         └─ Sorting est. ? rows
            │     Order by: {expr#'store'_2 asc, i_brand_id_85 asc, i_class_id_85 asc, i_category_id_85 asc}
            │     Limit: 100
            └─ Inner Join est. ? rows
               │     Condition: 
               │     Filter: `expr#sum(multiply(ss_quantity, ss_list_price))_3` > `expr#avg(multiply(quantity, list_price))_9`
               ├─ Inner Join est. ? rows
               │  │     Condition: 
               │  │     Filter: `expr#sum(multiply(ss_quantity, ss_list_price))_2` > `expr#avg(multiply(quantity, list_price))_8`
               │  ├─ Inner Join est. 24396800 rows
               │  │  │     Condition: i_brand_id_85 == i_brand_id_92, i_category_id_85 == i_category_id_92, i_class_id_85 == i_class_id_92
               │  │  ├─ Projection est. 152480 rows
               │  │  │  │     Expressions: [expr#count()_4, expr#sum(multiply(ss_quantity, ss_list_price))_2, i_brand_id_85, i_category_id_85, i_class_id_85], expr#'store'_2:='store'
               │  │  │  └─ MergingAggregated est. 152480 rows
               │  │  │     └─ Repartition Exchange est. 152480 rows
               │  │  │        │     Partition by: {i_brand_id_85, i_category_id_85, i_class_id_85}
               │  │  │        └─ Aggregating est. 152480 rows
               │  │  │           │     Group by: {i_brand_id_85, i_category_id_85, i_class_id_85}
               │  │  │           │     Aggregates: expr#sum(multiply(ss_quantity, ss_list_price))_2:=AggNull(sum)(expr#multiply(ss_quantity, ss_list_price)_1), expr#count()_4:=AggNull(count)()
               │  │  │           └─ Projection est. 276682 rows
               │  │  │              │     Expressions: [i_brand_id_85, i_category_id_85, i_class_id_85], expr#multiply(ss_quantity, ss_list_price)_1:=ss_quantity_10 * ss_list_price_10
               │  │  │              └─ Inner Join est. 277057 rows
               │  │  │                 │     Condition: i_item_sk_75 == i_item_sk_70
               │  │  │                 ├─ MergingAggregated est. 299593 rows
               │  │  │                 │  └─ Repartition Exchange est. 299593 rows
               │  │  │                 │     │     Partition by: {i_item_sk_75}
               │  │  │                 │     └─ Aggregating est. 299593 rows
               │  │  │                 │        │     Group by: {i_item_sk_75}
               │  │  │                 │        └─ Projection est. 432016789 rows
               │  │  │                 │           │     Expressions: i_item_sk_75:=i_item_sk_102
               │  │  │                 │           └─ Inner Join est. 432016789 rows
               │  │  │                 │              │     Condition: i_brand_id_127 == i_brand_id_123, i_category_id_127 == i_category_id_123, i_class_id_127 == i_class_id_123
               │  │  │                 │              ├─ Repartition Exchange est. 3705264 rows
               │  │  │                 │              │  │     Partition by: {i_brand_id_127, i_category_id_127, i_class_id_127}
               │  │  │                 │              │  └─ Filter est. 3705264 rows
               │  │  │                 │              │     │     Condition: (count_71 >= 1) AND (count_70 >= 1) AND (count_69 >= 1)
               │  │  │                 │              │     └─ MergingAggregated est. 4116960 rows
               │  │  │                 │              │        └─ Repartition Exchange est. 4116960 rows
               │  │  │                 │              │           │     Partition by: {i_brand_id_127, i_category_id_127, i_class_id_127}
               │  │  │                 │              │           └─ Aggregating est. 4116960 rows
               │  │  │                 │              │              │     Group by: {i_brand_id_127, i_category_id_127, i_class_id_127}
               │  │  │                 │              │              │     Aggregates: count_69:=AggNull(sum)(marker_285), count_70:=AggNull(sum)(marker_286), count_71:=AggNull(sum)(marker_287)
               │  │  │                 │              │              └─ Union est. 2978735891 rows
               │  │  │                 │              │                 ├─ Projection est. 1705276524 rows
               │  │  │                 │              │                 │  │     Expressions: [i_brand_id_124, i_category_id_124, i_class_id_124], marker_276:=1, marker_277:=0, marker_278:=0
               │  │  │                 │              │                 │  └─ Inner Join est. 852638262 rows
               │  │  │                 │              │                 │     │     Condition: ss_item_sk_28 == i_item_sk_103
               │  │  │                 │              │                 │     ├─ Repartition Exchange est. 852638262 rows
               │  │  │                 │              │                 │     │  │     Partition by: {ss_item_sk_28}
               │  │  │                 │              │                 │     │  └─ Inner Join est. 852638262 rows
               │  │  │                 │              │                 │     │     │     Condition: ss_sold_date_sk_31 == d_date_sk_91
               │  │  │                 │              │                 │     │     ├─ Local Exchange est. 2879987999 rows
               │  │  │                 │              │                 │     │     │  └─ Filter est. 2879987999 rows
               │  │  │                 │              │                 │     │     │     │     Dynamic Filters: {ss_sold_date_sk_31:bloomfilter,ss_sold_date_sk_31:range}
               │  │  │                 │              │                 │     │     │     └─ TableScan tpcds.store_sales est. 2879987999 rows
               │  │  │                 │              │                 │     │     │              Outputs: ss_item_sk_28:=ss_item_sk, ss_sold_date_sk_31:=ss_sold_date_sk
               │  │  │                 │              │                 │     │     └─ Broadcast Exchange est. 1096 rows
               │  │  │                 │              │                 │     │        └─ Projection est. 1096 rows
               │  │  │                 │              │                 │     │           │     Expressions: [d_date_sk_91, d_year_91]
               │  │  │                 │              │                 │     │           │     Dynamic Filters Builder: {d_date_sk_91}
               │  │  │                 │              │                 │     │           └─ Filter est. 1096 rows
               │  │  │                 │              │                 │     │              │     Condition: (d_year_91 >= 1999) AND (d_year_91 <= 2001)
               │  │  │                 │              │                 │     │              └─ TableScan tpcds.date_dim est. 73049 rows
               │  │  │                 │              │                 │     │                       Outputs: d_date_sk_91:=d_date_sk, d_year_91:=d_year
               │  │  │                 │              │                 │     └─ Repartition Exchange est. 300000 rows
               │  │  │                 │              │                 │        │     Partition by: {i_item_sk_103}
               │  │  │                 │              │                 │        └─ TableScan tpcds.item est. 300000 rows
               │  │  │                 │              │                 │                 Outputs: i_brand_id_124:=i_brand_id, i_category_id_124:=i_category_id, i_class_id_124:=i_class_id, i_item_sk_103:=i_item_sk
               │  │  │                 │              │                 ├─ Projection est. 847138237 rows
               │  │  │                 │              │                 │  │     Expressions: [i_brand_id_125, i_category_id_125, i_class_id_125], marker_279:=0, marker_280:=1, marker_281:=0
               │  │  │                 │              │                 │  └─ Inner Join est. 423569118 rows
               │  │  │                 │              │                 │     │     Condition: cs_item_sk_26 == i_item_sk_104
               │  │  │                 │              │                 │     ├─ Repartition Exchange est. 423569118 rows
               │  │  │                 │              │                 │     │  │     Partition by: {cs_item_sk_26}
               │  │  │                 │              │                 │     │  └─ Inner Join est. 423569118 rows
               │  │  │                 │              │                 │     │     │     Condition: cs_sold_date_sk_29 == d_date_sk_92
               │  │  │                 │              │                 │     │     ├─ Local Exchange est. 1439980416 rows
               │  │  │                 │              │                 │     │     │  └─ Filter est. 1439980416 rows
               │  │  │                 │              │                 │     │     │     │     Dynamic Filters: {cs_sold_date_sk_29:bloomfilter,cs_sold_date_sk_29:range}
               │  │  │                 │              │                 │     │     │     └─ TableScan tpcds.catalog_sales est. 1439980416 rows
               │  │  │                 │              │                 │     │     │              Outputs: cs_item_sk_26:=cs_item_sk, cs_sold_date_sk_29:=cs_sold_date_sk
               │  │  │                 │              │                 │     │     └─ Broadcast Exchange est. 1096 rows
               │  │  │                 │              │                 │     │        └─ Projection est. 1096 rows
               │  │  │                 │              │                 │     │           │     Expressions: [d_date_sk_92, d_year_92]
               │  │  │                 │              │                 │     │           │     Dynamic Filters Builder: {d_date_sk_92}
               │  │  │                 │              │                 │     │           └─ Filter est. 1096 rows
               │  │  │                 │              │                 │     │              │     Condition: (d_year_92 >= 1999) AND (d_year_92 <= 2001)
               │  │  │                 │              │                 │     │              └─ TableScan tpcds.date_dim est. 73049 rows
               │  │  │                 │              │                 │     │                       Outputs: d_date_sk_92:=d_date_sk, d_year_92:=d_year
               │  │  │                 │              │                 │     └─ Repartition Exchange est. 300000 rows
               │  │  │                 │              │                 │        │     Partition by: {i_item_sk_104}
               │  │  │                 │              │                 │        └─ TableScan tpcds.item est. 300000 rows
               │  │  │                 │              │                 │                 Outputs: i_brand_id_125:=i_brand_id, i_category_id_125:=i_category_id, i_class_id_125:=i_class_id, i_item_sk_104:=i_item_sk
               │  │  │                 │              │                 └─ Projection est. 426321130 rows
               │  │  │                 │              │                    │     Expressions: [i_brand_id_126, i_category_id_126, i_class_id_126], marker_282:=0, marker_283:=0, marker_284:=1
               │  │  │                 │              │                    └─ Inner Join est. 213160565 rows
               │  │  │                 │              │                       │     Condition: ws_item_sk_26 == i_item_sk_105
               │  │  │                 │              │                       ├─ Repartition Exchange est. 213160565 rows
               │  │  │                 │              │                       │  │     Partition by: {ws_item_sk_26}
               │  │  │                 │              │                       │  └─ Inner Join est. 213160565 rows
               │  │  │                 │              │                       │     │     Condition: ws_sold_date_sk_29 == d_date_sk_93
               │  │  │                 │              │                       │     ├─ Local Exchange est. 720000376 rows
               │  │  │                 │              │                       │     │  └─ Filter est. 720000376 rows
               │  │  │                 │              │                       │     │     │     Dynamic Filters: {ws_sold_date_sk_29:bloomfilter,ws_sold_date_sk_29:range}
               │  │  │                 │              │                       │     │     └─ TableScan tpcds.web_sales est. 720000376 rows
               │  │  │                 │              │                       │     │              Outputs: ws_item_sk_26:=ws_item_sk, ws_sold_date_sk_29:=ws_sold_date_sk
               │  │  │                 │              │                       │     └─ Broadcast Exchange est. 1096 rows
               │  │  │                 │              │                       │        └─ Projection est. 1096 rows
               │  │  │                 │              │                       │           │     Expressions: [d_date_sk_93, d_year_93]
               │  │  │                 │              │                       │           │     Dynamic Filters Builder: {d_date_sk_93}
               │  │  │                 │              │                       │           └─ Filter est. 1096 rows
               │  │  │                 │              │                       │              │     Condition: (d_year_93 >= 1999) AND (d_year_93 <= 2001)
               │  │  │                 │              │                       │              └─ TableScan tpcds.date_dim est. 73049 rows
               │  │  │                 │              │                       │                       Outputs: d_date_sk_93:=d_date_sk, d_year_93:=d_year
               │  │  │                 │              │                       └─ Repartition Exchange est. 300000 rows
               │  │  │                 │              │                          │     Partition by: {i_item_sk_105}
               │  │  │                 │              │                          └─ TableScan tpcds.item est. 300000 rows
               │  │  │                 │              │                                   Outputs: i_brand_id_126:=i_brand_id, i_category_id_126:=i_category_id, i_class_id_126:=i_class_id, i_item_sk_105:=i_item_sk
               │  │  │                 │              └─ Repartition Exchange est. 300000 rows
               │  │  │                 │                 │     Partition by: {i_brand_id_123, i_category_id_123, i_class_id_123}
               │  │  │                 │                 └─ Filter est. 300000 rows
               │  │  │                 │                    │     Condition: isNotNull(i_item_sk_102)
               │  │  │                 │                    └─ TableScan tpcds.item est. 300000 rows
               │  │  │                 │                             Outputs: i_brand_id_123:=i_brand_id, i_category_id_123:=i_category_id, i_class_id_123:=i_class_id, i_item_sk_102:=i_item_sk
               │  │  │                 └─ Inner Join est. 277057 rows
               │  │  │                    │     Condition: i_item_sk_70 == ss_item_sk_18
               │  │  │                    ├─ Repartition Exchange est. 300000 rows
               │  │  │                    │  │     Partition by: {i_item_sk_70}
               │  │  │                    │  └─ Filter est. 300000 rows
               │  │  │                    │     │     Condition: isNotNull(i_item_sk_70)
               │  │  │                    │     └─ TableScan tpcds.item est. 300000 rows
               │  │  │                    │              Outputs: i_brand_id_85:=i_brand_id, i_category_id_85:=i_category_id, i_class_id_85:=i_class_id, i_item_sk_70:=i_item_sk
               │  │  │                    └─ Repartition Exchange est. 276682 rows
               │  │  │                       │     Partition by: {ss_item_sk_18}
               │  │  │                       └─ Inner Join est. 10891364 rows
               │  │  │                          │     Condition: ss_sold_date_sk_21 == d_date_sk_63
               │  │  │                          ├─ Local Exchange est. 2879987999 rows
               │  │  │                          │  └─ Filter est. 2879987999 rows
               │  │  │                          │     │     Condition: isNotNull(ss_item_sk_18)
               │  │  │                          │     │     Dynamic Filters: {ss_sold_date_sk_21:bloomfilter,ss_sold_date_sk_21:range}
               │  │  │                          │     └─ TableScan tpcds.store_sales est. 2879987999 rows
               │  │  │                          │              Outputs: ss_item_sk_18:=ss_item_sk, ss_list_price_10:=ss_list_price, ss_quantity_10:=ss_quantity, ss_sold_date_sk_21:=ss_sold_date_sk
               │  │  │                          └─ Broadcast Exchange est. 7 rows
               │  │  │                             └─ Projection est. 7 rows
               │  │  │                                │     Expressions: [d_date_sk_63]
               │  │  │                                │     Dynamic Filters Builder: {d_date_sk_63}
               │  │  │                                └─ Inner Join est. 7 rows
               │  │  │                                   │     Condition: d_week_seq_9 == d_week_seq_10
               │  │  │                                   ├─ TableScan tpcds.date_dim est. 73049 rows
               │  │  │                                   │        Outputs: d_date_sk_63:=d_date_sk, d_week_seq_9:=d_week_seq
               │  │  │                                   └─ Broadcast Exchange est. 1 rows
               │  │  │                                      └─ EnforceSingleRow est. 1 rows
               │  │  │                                         └─ Union est. 1 rows
               │  │  │                                            └─ Gather Exchange est. 1 rows
               │  │  │                                               └─ Projection est. 1 rows
               │  │  │                                                  │     Expressions: [d_week_seq_10]
               │  │  │                                                  └─ Filter est. 1 rows
               │  │  │                                                     │     Condition: (d_year_64 = 2000) AND (d_dom_10 = 11) AND (d_moy_10 = 12)
               │  │  │                                                     └─ TableScan tpcds.date_dim est. 73049 rows
               │  │  │                                                              Outputs: d_dom_10:=d_dom, d_moy_10:=d_moy, d_week_seq_10:=d_week_seq, d_year_64:=d_year
               │  │  └─ Projection est. 152480 rows
               │  │     │     Expressions: [expr#count()_5, expr#sum(multiply(ss_quantity, ss_list_price))_3, i_brand_id_92, i_category_id_92, i_class_id_92], expr#'store'_3:='store'
               │  │     └─ MergingAggregated est. 152480 rows
               │  │        └─ Repartition Exchange est. 152480 rows
               │  │           │     Partition by: {i_brand_id_92, i_category_id_92, i_class_id_92}
               │  │           └─ Aggregating est. 152480 rows
               │  │              │     Group by: {i_brand_id_92, i_category_id_92, i_class_id_92}
               │  │              │     Aggregates: expr#sum(multiply(ss_quantity, ss_list_price))_3:=AggNull(sum)(expr#multiply(ss_quantity, ss_list_price)_2), expr#count()_5:=AggNull(count)()
               │  │              └─ Projection est. 276682 rows
               │  │                 │     Expressions: [i_brand_id_92, i_category_id_92, i_class_id_92], expr#multiply(ss_quantity, ss_list_price)_2:=ss_quantity_14 * ss_list_price_14
               │  │                 └─ Inner Join est. 277057 rows
               │  │                    │     Condition: i_item_sk_77 == i_item_sk_76
               │  │                    ├─ MergingAggregated est. 299593 rows
               │  │                    │  └─ Repartition Exchange est. 299593 rows
               │  │                    │     │     Partition by: {i_item_sk_77}
               │  │                    │     └─ Aggregating est. 299593 rows
               │  │                    │        │     Group by: {i_item_sk_77}
               │  │                    │        └─ Projection est. 432016789 rows
               │  │                    │           │     Expressions: i_item_sk_77:=i_item_sk_106
               │  │                    │           └─ Inner Join est. 432016789 rows
               │  │                    │              │     Condition: i_brand_id_132 == i_brand_id_128, i_category_id_132 == i_category_id_128, i_class_id_132 == i_class_id_128
               │  │                    │              ├─ Repartition Exchange est. 3705264 rows
               │  │                    │              │  │     Partition by: {i_brand_id_132, i_category_id_132, i_class_id_132}
               │  │                    │              │  └─ Filter est. 3705264 rows
               │  │                    │              │     │     Condition: (count_72 >= 1) AND (count_73 >= 1) AND (count_74 >= 1)
               │  │                    │              │     └─ MergingAggregated est. 4116960 rows
               │  │                    │              │        └─ Repartition Exchange est. 4116960 rows
               │  │                    │              │           │     Partition by: {i_brand_id_132, i_category_id_132, i_class_id_132}
               │  │                    │              │           └─ Aggregating est. 4116960 rows
               │  │                    │              │              │     Group by: {i_brand_id_132, i_category_id_132, i_class_id_132}
               │  │                    │              │              │     Aggregates: count_72:=AggNull(sum)(marker_297), count_73:=AggNull(sum)(marker_298), count_74:=AggNull(sum)(marker_299)
               │  │                    │              │              └─ Union est. 2978735891 rows
               │  │                    │              │                 ├─ Projection est. 1705276524 rows
               │  │                    │              │                 │  │     Expressions: [i_brand_id_129, i_category_id_129, i_class_id_129], marker_288:=1, marker_289:=0, marker_290:=0
               │  │                    │              │                 │  └─ Inner Join est. 852638262 rows
               │  │                    │              │                 │     │     Condition: ss_item_sk_29 == i_item_sk_107
               │  │                    │              │                 │     ├─ Repartition Exchange est. 852638262 rows
               │  │                    │              │                 │     │  │     Partition by: {ss_item_sk_29}
               │  │                    │              │                 │     │  └─ Inner Join est. 852638262 rows
               │  │                    │              │                 │     │     │     Condition: ss_sold_date_sk_32 == d_date_sk_94
               │  │                    │              │                 │     │     ├─ Local Exchange est. 2879987999 rows
               │  │                    │              │                 │     │     │  └─ Filter est. 2879987999 rows
               │  │                    │              │                 │     │     │     │     Dynamic Filters: {ss_sold_date_sk_32:bloomfilter,ss_sold_date_sk_32:range}
               │  │                    │              │                 │     │     │     └─ TableScan tpcds.store_sales est. 2879987999 rows
               │  │                    │              │                 │     │     │              Outputs: ss_item_sk_29:=ss_item_sk, ss_sold_date_sk_32:=ss_sold_date_sk
               │  │                    │              │                 │     │     └─ Broadcast Exchange est. 1096 rows
               │  │                    │              │                 │     │        └─ Projection est. 1096 rows
               │  │                    │              │                 │     │           │     Expressions: [d_date_sk_94, d_year_94]
               │  │                    │              │                 │     │           │     Dynamic Filters Builder: {d_date_sk_94}
               │  │                    │              │                 │     │           └─ Filter est. 1096 rows
               │  │                    │              │                 │     │              │     Condition: (d_year_94 <= 2001) AND (d_year_94 >= 1999)
               │  │                    │              │                 │     │              └─ TableScan tpcds.date_dim est. 73049 rows
               │  │                    │              │                 │     │                       Outputs: d_date_sk_94:=d_date_sk, d_year_94:=d_year
               │  │                    │              │                 │     └─ Repartition Exchange est. 300000 rows
               │  │                    │              │                 │        │     Partition by: {i_item_sk_107}
               │  │                    │              │                 │        └─ TableScan tpcds.item est. 300000 rows
               │  │                    │              │                 │                 Outputs: i_brand_id_129:=i_brand_id, i_category_id_129:=i_category_id, i_class_id_129:=i_class_id, i_item_sk_107:=i_item_sk
               │  │                    │              │                 ├─ Projection est. 847138237 rows
               │  │                    │              │                 │  │     Expressions: [i_brand_id_130, i_category_id_130, i_class_id_130], marker_291:=0, marker_292:=1, marker_293:=0
               │  │                    │              │                 │  └─ Inner Join est. 423569118 rows
               │  │                    │              │                 │     │     Condition: cs_item_sk_27 == i_item_sk_108
               │  │                    │              │                 │     ├─ Repartition Exchange est. 423569118 rows
               │  │                    │              │                 │     │  │     Partition by: {cs_item_sk_27}
               │  │                    │              │                 │     │  └─ Inner Join est. 423569118 rows
               │  │                    │              │                 │     │     │     Condition: cs_sold_date_sk_30 == d_date_sk_95
               │  │                    │              │                 │     │     ├─ Local Exchange est. 1439980416 rows
               │  │                    │              │                 │     │     │  └─ Filter est. 1439980416 rows
               │  │                    │              │                 │     │     │     │     Dynamic Filters: {cs_sold_date_sk_30:bloomfilter,cs_sold_date_sk_30:range}
               │  │                    │              │                 │     │     │     └─ TableScan tpcds.catalog_sales est. 1439980416 rows
               │  │                    │              │                 │     │     │              Outputs: cs_item_sk_27:=cs_item_sk, cs_sold_date_sk_30:=cs_sold_date_sk
               │  │                    │              │                 │     │     └─ Broadcast Exchange est. 1096 rows
               │  │                    │              │                 │     │        └─ Projection est. 1096 rows
               │  │                    │              │                 │     │           │     Expressions: [d_date_sk_95, d_year_95]
               │  │                    │              │                 │     │           │     Dynamic Filters Builder: {d_date_sk_95}
               │  │                    │              │                 │     │           └─ Filter est. 1096 rows
               │  │                    │              │                 │     │              │     Condition: (d_year_95 <= 2001) AND (d_year_95 >= 1999)
               │  │                    │              │                 │     │              └─ TableScan tpcds.date_dim est. 73049 rows
               │  │                    │              │                 │     │                       Outputs: d_date_sk_95:=d_date_sk, d_year_95:=d_year
               │  │                    │              │                 │     └─ Repartition Exchange est. 300000 rows
               │  │                    │              │                 │        │     Partition by: {i_item_sk_108}
               │  │                    │              │                 │        └─ TableScan tpcds.item est. 300000 rows
               │  │                    │              │                 │                 Outputs: i_brand_id_130:=i_brand_id, i_category_id_130:=i_category_id, i_class_id_130:=i_class_id, i_item_sk_108:=i_item_sk
               │  │                    │              │                 └─ Projection est. 426321130 rows
               │  │                    │              │                    │     Expressions: [i_brand_id_131, i_category_id_131, i_class_id_131], marker_294:=0, marker_295:=0, marker_296:=1
               │  │                    │              │                    └─ Inner Join est. 213160565 rows
               │  │                    │              │                       │     Condition: ws_item_sk_27 == i_item_sk_109
               │  │                    │              │                       ├─ Repartition Exchange est. 213160565 rows
               │  │                    │              │                       │  │     Partition by: {ws_item_sk_27}
               │  │                    │              │                       │  └─ Inner Join est. 213160565 rows
               │  │                    │              │                       │     │     Condition: ws_sold_date_sk_30 == d_date_sk_96
               │  │                    │              │                       │     ├─ Local Exchange est. 720000376 rows
               │  │                    │              │                       │     │  └─ Filter est. 720000376 rows
               │  │                    │              │                       │     │     │     Dynamic Filters: {ws_sold_date_sk_30:bloomfilter,ws_sold_date_sk_30:range}
               │  │                    │              │                       │     │     └─ TableScan tpcds.web_sales est. 720000376 rows
               │  │                    │              │                       │     │              Outputs: ws_item_sk_27:=ws_item_sk, ws_sold_date_sk_30:=ws_sold_date_sk
               │  │                    │              │                       │     └─ Broadcast Exchange est. 1096 rows
               │  │                    │              │                       │        └─ Projection est. 1096 rows
               │  │                    │              │                       │           │     Expressions: [d_date_sk_96, d_year_96]
               │  │                    │              │                       │           │     Dynamic Filters Builder: {d_date_sk_96}
               │  │                    │              │                       │           └─ Filter est. 1096 rows
               │  │                    │              │                       │              │     Condition: (d_year_96 >= 1999) AND (d_year_96 <= 2001)
               │  │                    │              │                       │              └─ TableScan tpcds.date_dim est. 73049 rows
               │  │                    │              │                       │                       Outputs: d_date_sk_96:=d_date_sk, d_year_96:=d_year
               │  │                    │              │                       └─ Repartition Exchange est. 300000 rows
               │  │                    │              │                          │     Partition by: {i_item_sk_109}
               │  │                    │              │                          └─ TableScan tpcds.item est. 300000 rows
               │  │                    │              │                                   Outputs: i_brand_id_131:=i_brand_id, i_category_id_131:=i_category_id, i_class_id_131:=i_class_id, i_item_sk_109:=i_item_sk
               │  │                    │              └─ Repartition Exchange est. 300000 rows
               │  │                    │                 │     Partition by: {i_brand_id_128, i_category_id_128, i_class_id_128}
               │  │                    │                 └─ Filter est. 300000 rows
               │  │                    │                    │     Condition: isNotNull(i_item_sk_106)
               │  │                    │                    └─ TableScan tpcds.item est. 300000 rows
               │  │                    │                             Outputs: i_brand_id_128:=i_brand_id, i_category_id_128:=i_category_id, i_class_id_128:=i_class_id, i_item_sk_106:=i_item_sk
               │  │                    └─ Inner Join est. 277057 rows
               │  │                       │     Condition: i_item_sk_76 == ss_item_sk_21
               │  │                       ├─ Repartition Exchange est. 300000 rows
               │  │                       │  │     Partition by: {i_item_sk_76}
               │  │                       │  └─ Filter est. 300000 rows
               │  │                       │     │     Condition: isNotNull(i_item_sk_76)
               │  │                       │     └─ TableScan tpcds.item est. 300000 rows
               │  │                       │              Outputs: i_brand_id_92:=i_brand_id, i_category_id_92:=i_category_id, i_class_id_92:=i_class_id, i_item_sk_76:=i_item_sk
               │  │                       └─ Repartition Exchange est. 276682 rows
               │  │                          │     Partition by: {ss_item_sk_21}
               │  │                          └─ Inner Join est. 10891364 rows
               │  │                             │     Condition: ss_sold_date_sk_24 == d_date_sk_71
               │  │                             ├─ Local Exchange est. 2879987999 rows
               │  │                             │  └─ Filter est. 2879987999 rows
               │  │                             │     │     Condition: isNotNull(ss_item_sk_21)
               │  │                             │     │     Dynamic Filters: {ss_sold_date_sk_24:bloomfilter,ss_sold_date_sk_24:range}
               │  │                             │     └─ TableScan tpcds.store_sales est. 2879987999 rows
               │  │                             │              Outputs: ss_item_sk_21:=ss_item_sk, ss_list_price_14:=ss_list_price, ss_quantity_14:=ss_quantity, ss_sold_date_sk_24:=ss_sold_date_sk
               │  │                             └─ Broadcast Exchange est. 7 rows
               │  │                                └─ Projection est. 7 rows
               │  │                                   │     Expressions: [d_date_sk_71]
               │  │                                   │     Dynamic Filters Builder: {d_date_sk_71}
               │  │                                   └─ Inner Join est. 7 rows
               │  │                                      │     Condition: d_week_seq_17 == d_week_seq_18
               │  │                                      ├─ TableScan tpcds.date_dim est. 73049 rows
               │  │                                      │        Outputs: d_date_sk_71:=d_date_sk, d_week_seq_17:=d_week_seq
               │  │                                      └─ Broadcast Exchange est. 1 rows
               │  │                                         └─ EnforceSingleRow est. 1 rows
               │  │                                            └─ Union est. 1 rows
               │  │                                               └─ Gather Exchange est. 1 rows
               │  │                                                  └─ Projection est. 1 rows
               │  │                                                     │     Expressions: [d_week_seq_18]
               │  │                                                     └─ Filter est. 1 rows
               │  │                                                        │     Condition: (d_year_72 = 1999) AND (d_dom_18 = 11) AND (d_moy_18 = 12)
               │  │                                                        └─ TableScan tpcds.date_dim est. 73049 rows
               │  │                                                                 Outputs: d_dom_18:=d_dom, d_moy_18:=d_moy, d_week_seq_18:=d_week_seq, d_year_72:=d_year
               │  └─ Broadcast Exchange est. 1 rows
               │     └─ Projection est. 1 rows
               │        │     Expressions: expr#avg(multiply(quantity, list_price))_8:=`expr#avg(multiply(quantity, list_price))_10`
               │        └─ MergingAggregated est. 1 rows
               │           └─ Gather Exchange est. 1 rows
               │              └─ Aggregating est. 1 rows
               │                 │     Group by: {}
               │                 │     Aggregates: expr#avg(multiply(quantity, list_price))_10:=AggNull(avg)(expr#multiply(quantity, list_price)_5)
               │                 └─ Projection est. 1489367945 rows
               │                    │     Expressions: expr#multiply(quantity, list_price)_5:=ss_quantity_16 * ss_list_price_16
               │                    └─ Union est. 1489367945 rows
               │                       ├─ Inner Join est. 852638262 rows
               │                       │  │     Condition: ss_sold_date_sk_33 == d_date_sk_97
               │                       │  ├─ Local Exchange est. 2879987999 rows
               │                       │  │  └─ Filter est. 2879987999 rows
               │                       │  │     │     Dynamic Filters: {ss_sold_date_sk_33:bloomfilter,ss_sold_date_sk_33:range}
               │                       │  │     └─ TableScan tpcds.store_sales est. 2879987999 rows
               │                       │  │              Outputs: ss_list_price_15:=ss_list_price, ss_quantity_15:=ss_quantity, ss_sold_date_sk_33:=ss_sold_date_sk
               │                       │  └─ Broadcast Exchange est. 1096 rows
               │                       │     └─ Projection est. 1096 rows
               │                       │        │     Expressions: [d_date_sk_97, d_year_97]
               │                       │        │     Dynamic Filters Builder: {d_date_sk_97}
               │                       │        └─ Filter est. 1096 rows
               │                       │           │     Condition: (d_year_97 >= 1999) AND (d_year_97 <= 2001)
               │                       │           └─ TableScan tpcds.date_dim est. 73049 rows
               │                       │                    Outputs: d_date_sk_97:=d_date_sk, d_year_97:=d_year
               │                       ├─ Inner Join est. 423569118 rows
               │                       │  │     Condition: cs_sold_date_sk_31 == d_date_sk_98
               │                       │  ├─ Local Exchange est. 1439980416 rows
               │                       │  │  └─ Filter est. 1439980416 rows
               │                       │  │     │     Dynamic Filters: {cs_sold_date_sk_31:bloomfilter,cs_sold_date_sk_31:range}
               │                       │  │     └─ TableScan tpcds.catalog_sales est. 1439980416 rows
               │                       │  │              Outputs: cs_list_price_8:=cs_list_price, cs_quantity_8:=cs_quantity, cs_sold_date_sk_31:=cs_sold_date_sk
               │                       │  └─ Broadcast Exchange est. 1096 rows
               │                       │     └─ Projection est. 1096 rows
               │                       │        │     Expressions: [d_date_sk_98, d_year_98]
               │                       │        │     Dynamic Filters Builder: {d_date_sk_98}
               │                       │        └─ Filter est. 1096 rows
               │                       │           │     Condition: (d_year_98 >= 1999) AND (d_year_98 <= 2001)
               │                       │           └─ TableScan tpcds.date_dim est. 73049 rows
               │                       │                    Outputs: d_date_sk_98:=d_date_sk, d_year_98:=d_year
               │                       └─ Inner Join est. 213160565 rows
               │                          │     Condition: ws_sold_date_sk_31 == d_date_sk_99
               │                          ├─ Local Exchange est. 720000376 rows
               │                          │  └─ Filter est. 720000376 rows
               │                          │     │     Dynamic Filters: {ws_sold_date_sk_31:bloomfilter,ws_sold_date_sk_31:range}
               │                          │     └─ TableScan tpcds.web_sales est. 720000376 rows
               │                          │              Outputs: ws_list_price_8:=ws_list_price, ws_quantity_8:=ws_quantity, ws_sold_date_sk_31:=ws_sold_date_sk
               │                          └─ Broadcast Exchange est. 1096 rows
               │                             └─ Projection est. 1096 rows
               │                                │     Expressions: [d_date_sk_99, d_year_99]
               │                                │     Dynamic Filters Builder: {d_date_sk_99}
               │                                └─ Filter est. 1096 rows
               │                                   │     Condition: (d_year_99 >= 1999) AND (d_year_99 <= 2001)
               │                                   └─ TableScan tpcds.date_dim est. 73049 rows
               │                                            Outputs: d_date_sk_99:=d_date_sk, d_year_99:=d_year
               └─ Broadcast Exchange est. 1 rows
                  └─ Projection est. 1 rows
                     │     Expressions: expr#avg(multiply(quantity, list_price))_9:=`expr#avg(multiply(quantity, list_price))_11`
                     └─ MergingAggregated est. 1 rows
                        └─ Gather Exchange est. 1 rows
                           └─ Aggregating est. 1 rows
                              │     Group by: {}
                              │     Aggregates: expr#avg(multiply(quantity, list_price))_11:=AggNull(avg)(expr#multiply(quantity, list_price)_6)
                              └─ Projection est. 1489367945 rows
                                 │     Expressions: expr#multiply(quantity, list_price)_6:=ss_quantity_18 * ss_list_price_18
                                 └─ Union est. 1489367945 rows
                                    ├─ Inner Join est. 852638262 rows
                                    │  │     Condition: ss_sold_date_sk_34 == d_date_sk_100
                                    │  ├─ Local Exchange est. 2879987999 rows
                                    │  │  └─ Filter est. 2879987999 rows
                                    │  │     │     Dynamic Filters: {ss_sold_date_sk_34:bloomfilter,ss_sold_date_sk_34:range}
                                    │  │     └─ TableScan tpcds.store_sales est. 2879987999 rows
                                    │  │              Outputs: ss_list_price_17:=ss_list_price, ss_quantity_17:=ss_quantity, ss_sold_date_sk_34:=ss_sold_date_sk
                                    │  └─ Broadcast Exchange est. 1096 rows
                                    │     └─ Projection est. 1096 rows
                                    │        │     Expressions: [d_date_sk_100, d_year_100]
                                    │        │     Dynamic Filters Builder: {d_date_sk_100}
                                    │        └─ Filter est. 1096 rows
                                    │           │     Condition: (d_year_100 <= 2001) AND (d_year_100 >= 1999)
                                    │           └─ TableScan tpcds.date_dim est. 73049 rows
                                    │                    Outputs: d_date_sk_100:=d_date_sk, d_year_100:=d_year
                                    ├─ Inner Join est. 423569118 rows
                                    │  │     Condition: cs_sold_date_sk_32 == d_date_sk_101
                                    │  ├─ Local Exchange est. 1439980416 rows
                                    │  │  └─ Filter est. 1439980416 rows
                                    │  │     │     Dynamic Filters: {cs_sold_date_sk_32:bloomfilter,cs_sold_date_sk_32:range}
                                    │  │     └─ TableScan tpcds.catalog_sales est. 1439980416 rows
                                    │  │              Outputs: cs_list_price_9:=cs_list_price, cs_quantity_9:=cs_quantity, cs_sold_date_sk_32:=cs_sold_date_sk
                                    │  └─ Broadcast Exchange est. 1096 rows
                                    │     └─ Projection est. 1096 rows
                                    │        │     Expressions: [d_date_sk_101, d_year_101]
                                    │        │     Dynamic Filters Builder: {d_date_sk_101}
                                    │        └─ Filter est. 1096 rows
                                    │           │     Condition: (d_year_101 >= 1999) AND (d_year_101 <= 2001)
                                    │           └─ TableScan tpcds.date_dim est. 73049 rows
                                    │                    Outputs: d_date_sk_101:=d_date_sk, d_year_101:=d_year
                                    └─ Inner Join est. 213160565 rows
                                       │     Condition: ws_sold_date_sk_32 == d_date_sk_102
                                       ├─ Local Exchange est. 720000376 rows
                                       │  └─ Filter est. 720000376 rows
                                       │     │     Dynamic Filters: {ws_sold_date_sk_32:bloomfilter,ws_sold_date_sk_32:range}
                                       │     └─ TableScan tpcds.web_sales est. 720000376 rows
                                       │              Outputs: ws_list_price_9:=ws_list_price, ws_quantity_9:=ws_quantity, ws_sold_date_sk_32:=ws_sold_date_sk
                                       └─ Broadcast Exchange est. 1096 rows
                                          └─ Projection est. 1096 rows
                                             │     Expressions: [d_date_sk_102, d_year_102]
                                             │     Dynamic Filters Builder: {d_date_sk_102}
                                             └─ Filter est. 1096 rows
                                                │     Condition: (d_year_102 <= 2001) AND (d_year_102 >= 1999)
                                                └─ TableScan tpcds.date_dim est. 73049 rows
                                                         Outputs: d_date_sk_102:=d_date_sk, d_year_102:=d_year
note: Dynamic Filter is applied for 28 times.
