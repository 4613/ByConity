Projection Est. 100 rows
│     Expressions: channel:=`expr#'store'_1`, i_brand_id:=i_brand_id_21, i_category_id:=i_category_id_21, i_class_id:=i_class_id_21, sum(number_sales):=`expr#sum(number_sales)`, sum(sales):=`expr#sum(sales)`
└─ Limit Est. 100 rows
   │     Limit: 100
   └─ Sorting Est. 100 rows
      │     Order by: {expr#'store'_1 asc, i_brand_id_21 asc, i_class_id_21 asc, i_category_id_21 asc}
      │     Limit: 100
      └─ Gather Exchange Est. ? rows
         └─ Sorting Est. 100 rows
            │     Order by: {expr#'store'_1 asc, i_brand_id_21 asc, i_class_id_21 asc, i_category_id_21 asc}
            │     Limit: 100
            └─ Aggregating Est. ? rows
               │     Group by: {expr#'store'_1, i_brand_id_21, i_category_id_21, i_class_id_21}
               │     Aggregates: expr#sum(sales):=AggNull(sum)(expr#sum(multiply(ss_quantity, ss_list_price))_1), expr#sum(number_sales):=AggNull(sum)(expr#count()_3)
               └─ Union Est. ? rows
                  ├─ Projection Est. ? rows
                  │  │     Expressions: [expr#count(), expr#sum(multiply(ss_quantity, ss_list_price)), i_brand_id, i_category_id, i_class_id], expr#'store':='store'
                  │  └─ Inner Join Est. ? rows
                  │     │     Condition: 
                  │     │     Filter: `expr#sum(multiply(ss_quantity, ss_list_price))` > `expr#avg(multiply(quantity, list_price))`
                  │     ├─ MergingAggregated Est. ? rows
                  │     │  └─ Repartition Exchange Est. ? rows
                  │     │     │     Partition by: {i_brand_id, i_category_id, i_class_id}
                  │     │     └─ Aggregating Est. ? rows
                  │     │        │     Group by: {i_brand_id, i_category_id, i_class_id}
                  │     │        │     Aggregates: expr#sum(multiply(ss_quantity, ss_list_price)):=AggNull(sum)(expr#multiply(ss_quantity, ss_list_price)), expr#count():=AggNull(count)()
                  │     │        └─ Projection Est. ? rows
                  │     │           │     Expressions: [i_brand_id, i_category_id, i_class_id], expr#multiply(ss_quantity, ss_list_price):=ss_quantity * ss_list_price
                  │     │           └─ Inner Join Est. ? rows
                  │     │              │     Condition: i_item_sk == i_item_sk_1
                  │     │              ├─ Repartition Exchange Est. ? rows
                  │     │              │  │     Partition by: {i_item_sk}
                  │     │              │  └─ Inner Join Est. ? rows
                  │     │              │     │     Condition: ss_sold_date_sk == d_date_sk
                  │     │              │     ├─ Repartition Exchange Est. ? rows
                  │     │              │     │  │     Partition by: {ss_sold_date_sk}
                  │     │              │     │  └─ Inner Join Est. ? rows
                  │     │              │     │     │     Condition: ss_item_sk == i_item_sk
                  │     │              │     │     ├─ Repartition Exchange Est. ? rows
                  │     │              │     │     │  │     Partition by: {ss_item_sk}
                  │     │              │     │     │  └─ Filter Est. ? rows
                  │     │              │     │     │     │     Condition: isNotNull(ss_item_sk)
                  │     │              │     │     │     └─ TableScan tpcds.store_sales Est. ? rows
                  │     │              │     │     │              Where: isNotNull(ss_item_sk)
                  │     │              │     │     │              Outputs: [ss_item_sk, ss_list_price, ss_quantity, ss_sold_date_sk]
                  │     │              │     │     └─ Repartition Exchange Est. ? rows
                  │     │              │     │        │     Partition by: {i_item_sk}
                  │     │              │     │        └─ Filter Est. ? rows
                  │     │              │     │           │     Condition: isNotNull(i_item_sk)
                  │     │              │     │           └─ TableScan tpcds.item Est. ? rows
                  │     │              │     │                    Where: isNotNull(i_item_sk)
                  │     │              │     │                    Outputs: [i_brand_id, i_category_id, i_class_id, i_item_sk]
                  │     │              │     └─ Repartition Exchange Est. ? rows
                  │     │              │        │     Partition by: {d_date_sk}
                  │     │              │        └─ Filter Est. ? rows
                  │     │              │           │     Condition: (d_year = 2001) AND (d_moy = 11)
                  │     │              │           └─ TableScan tpcds.date_dim Est. ? rows
                  │     │              │                    Where: (d_year = 2001) AND (d_moy = 11)
                  │     │              │                    Outputs: [d_date_sk, d_moy, d_year]
                  │     │              └─ MergingAggregated Est. ? rows
                  │     │                 └─ Repartition Exchange Est. ? rows
                  │     │                    │     Partition by: {i_item_sk_1}
                  │     │                    └─ Aggregating Est. ? rows
                  │     │                       │     Group by: {i_item_sk_1}
                  │     │                       └─ Inner Join Est. ? rows
                  │     │                          │     Condition: i_brand_id_1 == i_brand_id_6, i_category_id_1 == i_category_id_6, i_class_id_1 == i_class_id_6
                  │     │                          ├─ Repartition Exchange Est. ? rows
                  │     │                          │  │     Partition by: {i_brand_id_1, i_category_id_1, i_class_id_1}
                  │     │                          │  └─ Filter Est. ? rows
                  │     │                          │     │     Condition: isNotNull(i_item_sk_1)
                  │     │                          │     └─ TableScan tpcds.item Est. ? rows
                  │     │                          │              Where: isNotNull(i_item_sk)
                  │     │                          │              Outputs: i_brand_id_1:=i_brand_id, i_category_id_1:=i_category_id, i_class_id_1:=i_class_id, i_item_sk_1:=i_item_sk
                  │     │                          └─ Repartition Exchange Est. ? rows
                  │     │                             │     Partition by: {i_brand_id_6, i_category_id_6, i_class_id_6}
                  │     │                             └─ Filter Est. ? rows
                  │     │                                │     Condition: (count >= 1) AND (count_1 >= 1) AND (count_2 >= 1)
                  │     │                                └─ MergingAggregated Est. ? rows
                  │     │                                   └─ Repartition Exchange Est. ? rows
                  │     │                                      │     Partition by: {i_brand_id_6, i_category_id_6, i_class_id_6}
                  │     │                                      └─ Union Est. ? rows
                  │     │                                         ├─ Aggregating Est. ? rows
                  │     │                                         │  │     Group by: {i_brand_id_2, i_category_id_2, i_class_id_2}
                  │     │                                         │  │     Aggregates: count:=AggNull(sum)(marker_3), count_1:=AggNull(sum)(marker_4), count_2:=AggNull(sum)(marker_5)
                  │     │                                         │  └─ Projection Est. ? rows
                  │     │                                         │     │     Expressions: [i_brand_id_2, i_category_id_2, i_class_id_2], marker_3:=1, marker_4:=0, marker_5:=0
                  │     │                                         │     └─ Inner Join Est. ? rows
                  │     │                                         │        │     Condition: ss_sold_date_sk_1 == d_date_sk_1
                  │     │                                         │        ├─ Repartition Exchange Est. ? rows
                  │     │                                         │        │  │     Partition by: {ss_sold_date_sk_1}
                  │     │                                         │        │  └─ Inner Join Est. ? rows
                  │     │                                         │        │     │     Condition: ss_item_sk_1 == i_item_sk_2
                  │     │                                         │        │     ├─ Repartition Exchange Est. ? rows
                  │     │                                         │        │     │  │     Partition by: {ss_item_sk_1}
                  │     │                                         │        │     │  └─ TableScan tpcds.store_sales Est. ? rows
                  │     │                                         │        │     │           Outputs: ss_item_sk_1:=ss_item_sk, ss_sold_date_sk_1:=ss_sold_date_sk
                  │     │                                         │        │     └─ Repartition Exchange Est. ? rows
                  │     │                                         │        │        │     Partition by: {i_item_sk_2}
                  │     │                                         │        │        └─ TableScan tpcds.item Est. ? rows
                  │     │                                         │        │                 Outputs: i_brand_id_2:=i_brand_id, i_category_id_2:=i_category_id, i_class_id_2:=i_class_id, i_item_sk_2:=i_item_sk
                  │     │                                         │        └─ Repartition Exchange Est. ? rows
                  │     │                                         │           │     Partition by: {d_date_sk_1}
                  │     │                                         │           └─ Filter Est. ? rows
                  │     │                                         │              │     Condition: (d_year_1 >= 1999) AND (d_year_1 <= 2001)
                  │     │                                         │              └─ TableScan tpcds.date_dim Est. ? rows
                  │     │                                         │                       Where: (d_year >= 1999) AND (d_year <= 2001)
                  │     │                                         │                       Outputs: d_date_sk_1:=d_date_sk, d_year_1:=d_year
                  │     │                                         ├─ Aggregating Est. ? rows
                  │     │                                         │  │     Group by: {i_brand_id_3, i_category_id_3, i_class_id_3}
                  │     │                                         │  │     Aggregates: count:=AggNull(sum)(marker_6), count_1:=AggNull(sum)(marker_7), count_2:=AggNull(sum)(marker_8)
                  │     │                                         │  └─ Projection Est. ? rows
                  │     │                                         │     │     Expressions: [i_brand_id_3, i_category_id_3, i_class_id_3], marker_6:=0, marker_7:=1, marker_8:=0
                  │     │                                         │     └─ Inner Join Est. ? rows
                  │     │                                         │        │     Condition: cs_sold_date_sk == d_date_sk_2
                  │     │                                         │        ├─ Repartition Exchange Est. ? rows
                  │     │                                         │        │  │     Partition by: {cs_sold_date_sk}
                  │     │                                         │        │  └─ Inner Join Est. ? rows
                  │     │                                         │        │     │     Condition: cs_item_sk == i_item_sk_3
                  │     │                                         │        │     ├─ Repartition Exchange Est. ? rows
                  │     │                                         │        │     │  │     Partition by: {cs_item_sk}
                  │     │                                         │        │     │  └─ TableScan tpcds.catalog_sales Est. ? rows
                  │     │                                         │        │     │           Outputs: [cs_item_sk, cs_sold_date_sk]
                  │     │                                         │        │     └─ Repartition Exchange Est. ? rows
                  │     │                                         │        │        │     Partition by: {i_item_sk_3}
                  │     │                                         │        │        └─ TableScan tpcds.item Est. ? rows
                  │     │                                         │        │                 Outputs: i_brand_id_3:=i_brand_id, i_category_id_3:=i_category_id, i_class_id_3:=i_class_id, i_item_sk_3:=i_item_sk
                  │     │                                         │        └─ Repartition Exchange Est. ? rows
                  │     │                                         │           │     Partition by: {d_date_sk_2}
                  │     │                                         │           └─ Filter Est. ? rows
                  │     │                                         │              │     Condition: (d_year_2 >= 1999) AND (d_year_2 <= 2001)
                  │     │                                         │              └─ TableScan tpcds.date_dim Est. ? rows
                  │     │                                         │                       Where: (d_year >= 1999) AND (d_year <= 2001)
                  │     │                                         │                       Outputs: d_date_sk_2:=d_date_sk, d_year_2:=d_year
                  │     │                                         └─ Aggregating Est. ? rows
                  │     │                                            │     Group by: {i_brand_id_5, i_category_id_5, i_class_id_5}
                  │     │                                            │     Aggregates: count:=AggNull(sum)(marker_9), count_1:=AggNull(sum)(marker_10), count_2:=AggNull(sum)(marker_11)
                  │     │                                            └─ Projection Est. ? rows
                  │     │                                               │     Expressions: [i_brand_id_5, i_category_id_5, i_class_id_5], marker_10:=0, marker_11:=1, marker_9:=0
                  │     │                                               └─ Inner Join Est. ? rows
                  │     │                                                  │     Condition: ws_sold_date_sk == d_date_sk_3
                  │     │                                                  ├─ Repartition Exchange Est. ? rows
                  │     │                                                  │  │     Partition by: {ws_sold_date_sk}
                  │     │                                                  │  └─ Inner Join Est. ? rows
                  │     │                                                  │     │     Condition: ws_item_sk == i_item_sk_4
                  │     │                                                  │     ├─ Repartition Exchange Est. ? rows
                  │     │                                                  │     │  │     Partition by: {ws_item_sk}
                  │     │                                                  │     │  └─ TableScan tpcds.web_sales Est. ? rows
                  │     │                                                  │     │           Outputs: [ws_item_sk, ws_sold_date_sk]
                  │     │                                                  │     └─ Repartition Exchange Est. ? rows
                  │     │                                                  │        │     Partition by: {i_item_sk_4}
                  │     │                                                  │        └─ TableScan tpcds.item Est. ? rows
                  │     │                                                  │                 Outputs: i_brand_id_5:=i_brand_id, i_category_id_5:=i_category_id, i_class_id_5:=i_class_id, i_item_sk_4:=i_item_sk
                  │     │                                                  └─ Repartition Exchange Est. ? rows
                  │     │                                                     │     Partition by: {d_date_sk_3}
                  │     │                                                     └─ Filter Est. ? rows
                  │     │                                                        │     Condition: (d_year_3 >= 1999) AND (d_year_3 <= 2001)
                  │     │                                                        └─ TableScan tpcds.date_dim Est. ? rows
                  │     │                                                                 Where: (d_year >= 1999) AND (d_year <= 2001)
                  │     │                                                                 Outputs: d_date_sk_3:=d_date_sk, d_year_3:=d_year
                  │     └─ Broadcast Exchange Est. ? rows
                  │        └─ MergingAggregated Est. ? rows
                  │           └─ Gather Exchange Est. ? rows
                  │              └─ Aggregating Est. ? rows
                  │                 │     Group by: {}
                  │                 │     Aggregates: expr#avg(multiply(quantity, list_price)):=AggNull(avg)(expr#multiply(quantity, list_price))
                  │                 └─ Projection Est. ? rows
                  │                    │     Expressions: expr#multiply(quantity, list_price):=ss_quantity_2 * ss_list_price_2
                  │                    └─ Union Est. ? rows
                  │                       ├─ Inner Join Est. ? rows
                  │                       │  │     Condition: ss_sold_date_sk_2 == d_date_sk_4
                  │                       │  ├─ Repartition Exchange Est. ? rows
                  │                       │  │  │     Partition by: {ss_sold_date_sk_2}
                  │                       │  │  └─ TableScan tpcds.store_sales Est. ? rows
                  │                       │  │           Outputs: ss_list_price_1:=ss_list_price, ss_quantity_1:=ss_quantity, ss_sold_date_sk_2:=ss_sold_date_sk
                  │                       │  └─ Repartition Exchange Est. ? rows
                  │                       │     │     Partition by: {d_date_sk_4}
                  │                       │     └─ Filter Est. ? rows
                  │                       │        │     Condition: (d_year_4 >= 1999) AND (d_year_4 <= 2001)
                  │                       │        └─ TableScan tpcds.date_dim Est. ? rows
                  │                       │                 Where: (d_year >= 1999) AND (d_year <= 2001)
                  │                       │                 Outputs: d_date_sk_4:=d_date_sk, d_year_4:=d_year
                  │                       ├─ Inner Join Est. ? rows
                  │                       │  │     Condition: cs_sold_date_sk_1 == d_date_sk_5
                  │                       │  ├─ Repartition Exchange Est. ? rows
                  │                       │  │  │     Partition by: {cs_sold_date_sk_1}
                  │                       │  │  └─ TableScan tpcds.catalog_sales Est. ? rows
                  │                       │  │           Outputs: [cs_list_price, cs_quantity], cs_sold_date_sk_1:=cs_sold_date_sk
                  │                       │  └─ Repartition Exchange Est. ? rows
                  │                       │     │     Partition by: {d_date_sk_5}
                  │                       │     └─ Filter Est. ? rows
                  │                       │        │     Condition: (d_year_5 >= 1999) AND (d_year_5 <= 2001)
                  │                       │        └─ TableScan tpcds.date_dim Est. ? rows
                  │                       │                 Where: (d_year >= 1999) AND (d_year <= 2001)
                  │                       │                 Outputs: d_date_sk_5:=d_date_sk, d_year_5:=d_year
                  │                       └─ Inner Join Est. ? rows
                  │                          │     Condition: ws_sold_date_sk_1 == d_date_sk_6
                  │                          ├─ Repartition Exchange Est. ? rows
                  │                          │  │     Partition by: {ws_sold_date_sk_1}
                  │                          │  └─ TableScan tpcds.web_sales Est. ? rows
                  │                          │           Outputs: [ws_list_price, ws_quantity], ws_sold_date_sk_1:=ws_sold_date_sk
                  │                          └─ Repartition Exchange Est. ? rows
                  │                             │     Partition by: {d_date_sk_6}
                  │                             └─ Filter Est. ? rows
                  │                                │     Condition: (d_year_6 >= 1999) AND (d_year_6 <= 2001)
                  │                                └─ TableScan tpcds.date_dim Est. ? rows
                  │                                         Where: (d_year >= 1999) AND (d_year <= 2001)
                  │                                         Outputs: d_date_sk_6:=d_date_sk, d_year_6:=d_year
                  ├─ Projection Est. ? rows
                  │  │     Expressions: [expr#count()_1, expr#sum(multiply(cs_quantity, cs_list_price)), i_brand_id_7, i_category_id_7, i_class_id_7], expr#'catalog':='catalog'
                  │  └─ Inner Join Est. ? rows
                  │     │     Condition: 
                  │     │     Filter: `expr#sum(multiply(cs_quantity, cs_list_price))` > `expr#avg(multiply(quantity, list_price))_1`
                  │     ├─ MergingAggregated Est. ? rows
                  │     │  └─ Repartition Exchange Est. ? rows
                  │     │     │     Partition by: {i_brand_id_7, i_category_id_7, i_class_id_7}
                  │     │     └─ Aggregating Est. ? rows
                  │     │        │     Group by: {i_brand_id_7, i_category_id_7, i_class_id_7}
                  │     │        │     Aggregates: expr#sum(multiply(cs_quantity, cs_list_price)):=AggNull(sum)(expr#multiply(cs_quantity, cs_list_price)), expr#count()_1:=AggNull(count)()
                  │     │        └─ Projection Est. ? rows
                  │     │           │     Expressions: [i_brand_id_7, i_category_id_7, i_class_id_7], expr#multiply(cs_quantity, cs_list_price):=cs_quantity_1 * cs_list_price_1
                  │     │           └─ Inner Join Est. ? rows
                  │     │              │     Condition: cs_item_sk_1 == i_item_sk_6
                  │     │              ├─ Repartition Exchange Est. ? rows
                  │     │              │  │     Partition by: {cs_item_sk_1}
                  │     │              │  └─ Inner Join Est. ? rows
                  │     │              │     │     Condition: cs_sold_date_sk_2 == d_date_sk_7
                  │     │              │     ├─ Repartition Exchange Est. ? rows
                  │     │              │     │  │     Partition by: {cs_sold_date_sk_2}
                  │     │              │     │  └─ Inner Join Est. ? rows
                  │     │              │     │     │     Condition: cs_item_sk_1 == i_item_sk_5
                  │     │              │     │     ├─ Repartition Exchange Est. ? rows
                  │     │              │     │     │  │     Partition by: {cs_item_sk_1}
                  │     │              │     │     │  └─ Filter Est. ? rows
                  │     │              │     │     │     │     Condition: isNotNull(cs_item_sk_1)
                  │     │              │     │     │     └─ TableScan tpcds.catalog_sales Est. ? rows
                  │     │              │     │     │              Where: isNotNull(cs_item_sk)
                  │     │              │     │     │              Outputs: cs_item_sk_1:=cs_item_sk, cs_list_price_1:=cs_list_price, cs_quantity_1:=cs_quantity, cs_sold_date_sk_2:=cs_sold_date_sk
                  │     │              │     │     └─ Repartition Exchange Est. ? rows
                  │     │              │     │        │     Partition by: {i_item_sk_5}
                  │     │              │     │        └─ Filter Est. ? rows
                  │     │              │     │           │     Condition: isNotNull(i_item_sk_5)
                  │     │              │     │           └─ TableScan tpcds.item Est. ? rows
                  │     │              │     │                    Where: isNotNull(i_item_sk)
                  │     │              │     │                    Outputs: i_brand_id_7:=i_brand_id, i_category_id_7:=i_category_id, i_class_id_7:=i_class_id, i_item_sk_5:=i_item_sk
                  │     │              │     └─ Repartition Exchange Est. ? rows
                  │     │              │        │     Partition by: {d_date_sk_7}
                  │     │              │        └─ Filter Est. ? rows
                  │     │              │           │     Condition: (d_moy_1 = 11) AND (d_year_7 = 2001)
                  │     │              │           └─ TableScan tpcds.date_dim Est. ? rows
                  │     │              │                    Where: (d_moy = 11) AND (d_year = 2001)
                  │     │              │                    Outputs: d_date_sk_7:=d_date_sk, d_moy_1:=d_moy, d_year_7:=d_year
                  │     │              └─ MergingAggregated Est. ? rows
                  │     │                 └─ Repartition Exchange Est. ? rows
                  │     │                    │     Partition by: {i_item_sk_6}
                  │     │                    └─ Aggregating Est. ? rows
                  │     │                       │     Group by: {i_item_sk_6}
                  │     │                       └─ Inner Join Est. ? rows
                  │     │                          │     Condition: i_brand_id_8 == i_brand_id_13, i_category_id_8 == i_category_id_13, i_class_id_8 == i_class_id_13
                  │     │                          ├─ Repartition Exchange Est. ? rows
                  │     │                          │  │     Partition by: {i_brand_id_8, i_category_id_8, i_class_id_8}
                  │     │                          │  └─ Filter Est. ? rows
                  │     │                          │     │     Condition: isNotNull(i_item_sk_6)
                  │     │                          │     └─ TableScan tpcds.item Est. ? rows
                  │     │                          │              Where: isNotNull(i_item_sk)
                  │     │                          │              Outputs: i_brand_id_8:=i_brand_id, i_category_id_8:=i_category_id, i_class_id_8:=i_class_id, i_item_sk_6:=i_item_sk
                  │     │                          └─ Repartition Exchange Est. ? rows
                  │     │                             │     Partition by: {i_brand_id_13, i_category_id_13, i_class_id_13}
                  │     │                             └─ Filter Est. ? rows
                  │     │                                │     Condition: (count_3 >= 1) AND (count_4 >= 1) AND (count_5 >= 1)
                  │     │                                └─ MergingAggregated Est. ? rows
                  │     │                                   └─ Repartition Exchange Est. ? rows
                  │     │                                      │     Partition by: {i_brand_id_13, i_category_id_13, i_class_id_13}
                  │     │                                      └─ Union Est. ? rows
                  │     │                                         ├─ Aggregating Est. ? rows
                  │     │                                         │  │     Group by: {i_brand_id_9, i_category_id_9, i_class_id_9}
                  │     │                                         │  │     Aggregates: count_3:=AggNull(sum)(marker_15), count_4:=AggNull(sum)(marker_16), count_5:=AggNull(sum)(marker_17)
                  │     │                                         │  └─ Projection Est. ? rows
                  │     │                                         │     │     Expressions: [i_brand_id_9, i_category_id_9, i_class_id_9], marker_15:=1, marker_16:=0, marker_17:=0
                  │     │                                         │     └─ Inner Join Est. ? rows
                  │     │                                         │        │     Condition: ss_sold_date_sk_3 == d_date_sk_8
                  │     │                                         │        ├─ Repartition Exchange Est. ? rows
                  │     │                                         │        │  │     Partition by: {ss_sold_date_sk_3}
                  │     │                                         │        │  └─ Inner Join Est. ? rows
                  │     │                                         │        │     │     Condition: ss_item_sk_2 == i_item_sk_7
                  │     │                                         │        │     ├─ Repartition Exchange Est. ? rows
                  │     │                                         │        │     │  │     Partition by: {ss_item_sk_2}
                  │     │                                         │        │     │  └─ TableScan tpcds.store_sales Est. ? rows
                  │     │                                         │        │     │           Outputs: ss_item_sk_2:=ss_item_sk, ss_sold_date_sk_3:=ss_sold_date_sk
                  │     │                                         │        │     └─ Repartition Exchange Est. ? rows
                  │     │                                         │        │        │     Partition by: {i_item_sk_7}
                  │     │                                         │        │        └─ TableScan tpcds.item Est. ? rows
                  │     │                                         │        │                 Outputs: i_brand_id_9:=i_brand_id, i_category_id_9:=i_category_id, i_class_id_9:=i_class_id, i_item_sk_7:=i_item_sk
                  │     │                                         │        └─ Repartition Exchange Est. ? rows
                  │     │                                         │           │     Partition by: {d_date_sk_8}
                  │     │                                         │           └─ Filter Est. ? rows
                  │     │                                         │              │     Condition: (d_year_8 >= 1999) AND (d_year_8 <= 2001)
                  │     │                                         │              └─ TableScan tpcds.date_dim Est. ? rows
                  │     │                                         │                       Where: (d_year >= 1999) AND (d_year <= 2001)
                  │     │                                         │                       Outputs: d_date_sk_8:=d_date_sk, d_year_8:=d_year
                  │     │                                         ├─ Aggregating Est. ? rows
                  │     │                                         │  │     Group by: {i_brand_id_10, i_category_id_10, i_class_id_10}
                  │     │                                         │  │     Aggregates: count_3:=AggNull(sum)(marker_18), count_4:=AggNull(sum)(marker_19), count_5:=AggNull(sum)(marker_20)
                  │     │                                         │  └─ Projection Est. ? rows
                  │     │                                         │     │     Expressions: [i_brand_id_10, i_category_id_10, i_class_id_10], marker_18:=0, marker_19:=1, marker_20:=0
                  │     │                                         │     └─ Inner Join Est. ? rows
                  │     │                                         │        │     Condition: cs_sold_date_sk_3 == d_date_sk_9
                  │     │                                         │        ├─ Repartition Exchange Est. ? rows
                  │     │                                         │        │  │     Partition by: {cs_sold_date_sk_3}
                  │     │                                         │        │  └─ Inner Join Est. ? rows
                  │     │                                         │        │     │     Condition: cs_item_sk_2 == i_item_sk_8
                  │     │                                         │        │     ├─ Repartition Exchange Est. ? rows
                  │     │                                         │        │     │  │     Partition by: {cs_item_sk_2}
                  │     │                                         │        │     │  └─ TableScan tpcds.catalog_sales Est. ? rows
                  │     │                                         │        │     │           Outputs: cs_item_sk_2:=cs_item_sk, cs_sold_date_sk_3:=cs_sold_date_sk
                  │     │                                         │        │     └─ Repartition Exchange Est. ? rows
                  │     │                                         │        │        │     Partition by: {i_item_sk_8}
                  │     │                                         │        │        └─ TableScan tpcds.item Est. ? rows
                  │     │                                         │        │                 Outputs: i_brand_id_10:=i_brand_id, i_category_id_10:=i_category_id, i_class_id_10:=i_class_id, i_item_sk_8:=i_item_sk
                  │     │                                         │        └─ Repartition Exchange Est. ? rows
                  │     │                                         │           │     Partition by: {d_date_sk_9}
                  │     │                                         │           └─ Filter Est. ? rows
                  │     │                                         │              │     Condition: (d_year_9 >= 1999) AND (d_year_9 <= 2001)
                  │     │                                         │              └─ TableScan tpcds.date_dim Est. ? rows
                  │     │                                         │                       Where: (d_year >= 1999) AND (d_year <= 2001)
                  │     │                                         │                       Outputs: d_date_sk_9:=d_date_sk, d_year_9:=d_year
                  │     │                                         └─ Aggregating Est. ? rows
                  │     │                                            │     Group by: {i_brand_id_12, i_category_id_12, i_class_id_12}
                  │     │                                            │     Aggregates: count_3:=AggNull(sum)(marker_21), count_4:=AggNull(sum)(marker_22), count_5:=AggNull(sum)(marker_23)
                  │     │                                            └─ Projection Est. ? rows
                  │     │                                               │     Expressions: [i_brand_id_12, i_category_id_12, i_class_id_12], marker_21:=0, marker_22:=0, marker_23:=1
                  │     │                                               └─ Inner Join Est. ? rows
                  │     │                                                  │     Condition: ws_sold_date_sk_2 == d_date_sk_10
                  │     │                                                  ├─ Repartition Exchange Est. ? rows
                  │     │                                                  │  │     Partition by: {ws_sold_date_sk_2}
                  │     │                                                  │  └─ Inner Join Est. ? rows
                  │     │                                                  │     │     Condition: ws_item_sk_1 == i_item_sk_9
                  │     │                                                  │     ├─ Repartition Exchange Est. ? rows
                  │     │                                                  │     │  │     Partition by: {ws_item_sk_1}
                  │     │                                                  │     │  └─ TableScan tpcds.web_sales Est. ? rows
                  │     │                                                  │     │           Outputs: ws_item_sk_1:=ws_item_sk, ws_sold_date_sk_2:=ws_sold_date_sk
                  │     │                                                  │     └─ Repartition Exchange Est. ? rows
                  │     │                                                  │        │     Partition by: {i_item_sk_9}
                  │     │                                                  │        └─ TableScan tpcds.item Est. ? rows
                  │     │                                                  │                 Outputs: i_brand_id_12:=i_brand_id, i_category_id_12:=i_category_id, i_class_id_12:=i_class_id, i_item_sk_9:=i_item_sk
                  │     │                                                  └─ Repartition Exchange Est. ? rows
                  │     │                                                     │     Partition by: {d_date_sk_10}
                  │     │                                                     └─ Filter Est. ? rows
                  │     │                                                        │     Condition: (d_year_10 >= 1999) AND (d_year_10 <= 2001)
                  │     │                                                        └─ TableScan tpcds.date_dim Est. ? rows
                  │     │                                                                 Where: (d_year >= 1999) AND (d_year <= 2001)
                  │     │                                                                 Outputs: d_date_sk_10:=d_date_sk, d_year_10:=d_year
                  │     └─ Broadcast Exchange Est. ? rows
                  │        └─ MergingAggregated Est. ? rows
                  │           └─ Gather Exchange Est. ? rows
                  │              └─ Aggregating Est. ? rows
                  │                 │     Group by: {}
                  │                 │     Aggregates: expr#avg(multiply(quantity, list_price))_1:=AggNull(avg)(expr#multiply(quantity, list_price)_1)
                  │                 └─ Projection Est. ? rows
                  │                    │     Expressions: expr#multiply(quantity, list_price)_1:=ss_quantity_4 * ss_list_price_4
                  │                    └─ Union Est. ? rows
                  │                       ├─ Inner Join Est. ? rows
                  │                       │  │     Condition: ss_sold_date_sk_4 == d_date_sk_11
                  │                       │  ├─ Repartition Exchange Est. ? rows
                  │                       │  │  │     Partition by: {ss_sold_date_sk_4}
                  │                       │  │  └─ TableScan tpcds.store_sales Est. ? rows
                  │                       │  │           Outputs: ss_list_price_3:=ss_list_price, ss_quantity_3:=ss_quantity, ss_sold_date_sk_4:=ss_sold_date_sk
                  │                       │  └─ Repartition Exchange Est. ? rows
                  │                       │     │     Partition by: {d_date_sk_11}
                  │                       │     └─ Filter Est. ? rows
                  │                       │        │     Condition: (d_year_11 >= 1999) AND (d_year_11 <= 2001)
                  │                       │        └─ TableScan tpcds.date_dim Est. ? rows
                  │                       │                 Where: (d_year >= 1999) AND (d_year <= 2001)
                  │                       │                 Outputs: d_date_sk_11:=d_date_sk, d_year_11:=d_year
                  │                       ├─ Inner Join Est. ? rows
                  │                       │  │     Condition: cs_sold_date_sk_4 == d_date_sk_12
                  │                       │  ├─ Repartition Exchange Est. ? rows
                  │                       │  │  │     Partition by: {cs_sold_date_sk_4}
                  │                       │  │  └─ TableScan tpcds.catalog_sales Est. ? rows
                  │                       │  │           Outputs: cs_list_price_2:=cs_list_price, cs_quantity_2:=cs_quantity, cs_sold_date_sk_4:=cs_sold_date_sk
                  │                       │  └─ Repartition Exchange Est. ? rows
                  │                       │     │     Partition by: {d_date_sk_12}
                  │                       │     └─ Filter Est. ? rows
                  │                       │        │     Condition: (d_year_12 >= 1999) AND (d_year_12 <= 2001)
                  │                       │        └─ TableScan tpcds.date_dim Est. ? rows
                  │                       │                 Where: (d_year >= 1999) AND (d_year <= 2001)
                  │                       │                 Outputs: d_date_sk_12:=d_date_sk, d_year_12:=d_year
                  │                       └─ Inner Join Est. ? rows
                  │                          │     Condition: ws_sold_date_sk_3 == d_date_sk_13
                  │                          ├─ Repartition Exchange Est. ? rows
                  │                          │  │     Partition by: {ws_sold_date_sk_3}
                  │                          │  └─ TableScan tpcds.web_sales Est. ? rows
                  │                          │           Outputs: ws_list_price_1:=ws_list_price, ws_quantity_1:=ws_quantity, ws_sold_date_sk_3:=ws_sold_date_sk
                  │                          └─ Repartition Exchange Est. ? rows
                  │                             │     Partition by: {d_date_sk_13}
                  │                             └─ Filter Est. ? rows
                  │                                │     Condition: (d_year_13 >= 1999) AND (d_year_13 <= 2001)
                  │                                └─ TableScan tpcds.date_dim Est. ? rows
                  │                                         Where: (d_year >= 1999) AND (d_year <= 2001)
                  │                                         Outputs: d_date_sk_13:=d_date_sk, d_year_13:=d_year
                  └─ Projection Est. ? rows
                     │     Expressions: [expr#count()_2, expr#sum(multiply(ws_quantity, ws_list_price)), i_brand_id_14, i_category_id_14, i_class_id_14], expr#'web':='web'
                     └─ Inner Join Est. ? rows
                        │     Condition: 
                        │     Filter: `expr#sum(multiply(ws_quantity, ws_list_price))` > `expr#avg(multiply(quantity, list_price))_2`
                        ├─ MergingAggregated Est. ? rows
                        │  └─ Repartition Exchange Est. ? rows
                        │     │     Partition by: {i_brand_id_14, i_category_id_14, i_class_id_14}
                        │     └─ Aggregating Est. ? rows
                        │        │     Group by: {i_brand_id_14, i_category_id_14, i_class_id_14}
                        │        │     Aggregates: expr#sum(multiply(ws_quantity, ws_list_price)):=AggNull(sum)(expr#multiply(ws_quantity, ws_list_price)), expr#count()_2:=AggNull(count)()
                        │        └─ Projection Est. ? rows
                        │           │     Expressions: [i_brand_id_14, i_category_id_14, i_class_id_14], expr#multiply(ws_quantity, ws_list_price):=ws_quantity_2 * ws_list_price_2
                        │           └─ Inner Join Est. ? rows
                        │              │     Condition: i_item_sk_10 == i_item_sk_11
                        │              ├─ Repartition Exchange Est. ? rows
                        │              │  │     Partition by: {i_item_sk_10}
                        │              │  └─ Inner Join Est. ? rows
                        │              │     │     Condition: ws_sold_date_sk_4 == d_date_sk_14
                        │              │     ├─ Repartition Exchange Est. ? rows
                        │              │     │  │     Partition by: {ws_sold_date_sk_4}
                        │              │     │  └─ Inner Join Est. ? rows
                        │              │     │     │     Condition: ws_item_sk_2 == i_item_sk_10
                        │              │     │     ├─ Repartition Exchange Est. ? rows
                        │              │     │     │  │     Partition by: {ws_item_sk_2}
                        │              │     │     │  └─ Filter Est. ? rows
                        │              │     │     │     │     Condition: isNotNull(ws_item_sk_2)
                        │              │     │     │     └─ TableScan tpcds.web_sales Est. ? rows
                        │              │     │     │              Where: isNotNull(ws_item_sk)
                        │              │     │     │              Outputs: ws_item_sk_2:=ws_item_sk, ws_list_price_2:=ws_list_price, ws_quantity_2:=ws_quantity, ws_sold_date_sk_4:=ws_sold_date_sk
                        │              │     │     └─ Repartition Exchange Est. ? rows
                        │              │     │        │     Partition by: {i_item_sk_10}
                        │              │     │        └─ Filter Est. ? rows
                        │              │     │           │     Condition: isNotNull(i_item_sk_10)
                        │              │     │           └─ TableScan tpcds.item Est. ? rows
                        │              │     │                    Where: isNotNull(i_item_sk)
                        │              │     │                    Outputs: i_brand_id_14:=i_brand_id, i_category_id_14:=i_category_id, i_class_id_14:=i_class_id, i_item_sk_10:=i_item_sk
                        │              │     └─ Repartition Exchange Est. ? rows
                        │              │        │     Partition by: {d_date_sk_14}
                        │              │        └─ Filter Est. ? rows
                        │              │           │     Condition: (d_year_14 = 2001) AND (d_moy_2 = 11)
                        │              │           └─ TableScan tpcds.date_dim Est. ? rows
                        │              │                    Where: (d_year = 2001) AND (d_moy = 11)
                        │              │                    Outputs: d_date_sk_14:=d_date_sk, d_moy_2:=d_moy, d_year_14:=d_year
                        │              └─ MergingAggregated Est. ? rows
                        │                 └─ Repartition Exchange Est. ? rows
                        │                    │     Partition by: {i_item_sk_11}
                        │                    └─ Aggregating Est. ? rows
                        │                       │     Group by: {i_item_sk_11}
                        │                       └─ Inner Join Est. ? rows
                        │                          │     Condition: i_brand_id_15 == i_brand_id_20, i_category_id_15 == i_category_id_20, i_class_id_15 == i_class_id_20
                        │                          ├─ Repartition Exchange Est. ? rows
                        │                          │  │     Partition by: {i_brand_id_15, i_category_id_15, i_class_id_15}
                        │                          │  └─ Filter Est. ? rows
                        │                          │     │     Condition: isNotNull(i_item_sk_11)
                        │                          │     └─ TableScan tpcds.item Est. ? rows
                        │                          │              Where: isNotNull(i_item_sk)
                        │                          │              Outputs: i_brand_id_15:=i_brand_id, i_category_id_15:=i_category_id, i_class_id_15:=i_class_id, i_item_sk_11:=i_item_sk
                        │                          └─ Repartition Exchange Est. ? rows
                        │                             │     Partition by: {i_brand_id_20, i_category_id_20, i_class_id_20}
                        │                             └─ Filter Est. ? rows
                        │                                │     Condition: (count_6 >= 1) AND (count_7 >= 1) AND (count_8 >= 1)
                        │                                └─ MergingAggregated Est. ? rows
                        │                                   └─ Repartition Exchange Est. ? rows
                        │                                      │     Partition by: {i_brand_id_20, i_category_id_20, i_class_id_20}
                        │                                      └─ Union Est. ? rows
                        │                                         ├─ Aggregating Est. ? rows
                        │                                         │  │     Group by: {i_brand_id_16, i_category_id_16, i_class_id_16}
                        │                                         │  │     Aggregates: count_6:=AggNull(sum)(marker_27), count_7:=AggNull(sum)(marker_28), count_8:=AggNull(sum)(marker_29)
                        │                                         │  └─ Projection Est. ? rows
                        │                                         │     │     Expressions: [i_brand_id_16, i_category_id_16, i_class_id_16], marker_27:=1, marker_28:=0, marker_29:=0
                        │                                         │     └─ Inner Join Est. ? rows
                        │                                         │        │     Condition: ss_sold_date_sk_5 == d_date_sk_15
                        │                                         │        ├─ Repartition Exchange Est. ? rows
                        │                                         │        │  │     Partition by: {ss_sold_date_sk_5}
                        │                                         │        │  └─ Inner Join Est. ? rows
                        │                                         │        │     │     Condition: ss_item_sk_3 == i_item_sk_12
                        │                                         │        │     ├─ Repartition Exchange Est. ? rows
                        │                                         │        │     │  │     Partition by: {ss_item_sk_3}
                        │                                         │        │     │  └─ TableScan tpcds.store_sales Est. ? rows
                        │                                         │        │     │           Outputs: ss_item_sk_3:=ss_item_sk, ss_sold_date_sk_5:=ss_sold_date_sk
                        │                                         │        │     └─ Repartition Exchange Est. ? rows
                        │                                         │        │        │     Partition by: {i_item_sk_12}
                        │                                         │        │        └─ TableScan tpcds.item Est. ? rows
                        │                                         │        │                 Outputs: i_brand_id_16:=i_brand_id, i_category_id_16:=i_category_id, i_class_id_16:=i_class_id, i_item_sk_12:=i_item_sk
                        │                                         │        └─ Repartition Exchange Est. ? rows
                        │                                         │           │     Partition by: {d_date_sk_15}
                        │                                         │           └─ Filter Est. ? rows
                        │                                         │              │     Condition: (d_year_15 >= 1999) AND (d_year_15 <= 2001)
                        │                                         │              └─ TableScan tpcds.date_dim Est. ? rows
                        │                                         │                       Where: (d_year >= 1999) AND (d_year <= 2001)
                        │                                         │                       Outputs: d_date_sk_15:=d_date_sk, d_year_15:=d_year
                        │                                         ├─ Aggregating Est. ? rows
                        │                                         │  │     Group by: {i_brand_id_17, i_category_id_17, i_class_id_17}
                        │                                         │  │     Aggregates: count_6:=AggNull(sum)(marker_30), count_7:=AggNull(sum)(marker_31), count_8:=AggNull(sum)(marker_32)
                        │                                         │  └─ Projection Est. ? rows
                        │                                         │     │     Expressions: [i_brand_id_17, i_category_id_17, i_class_id_17], marker_30:=0, marker_31:=1, marker_32:=0
                        │                                         │     └─ Inner Join Est. ? rows
                        │                                         │        │     Condition: cs_sold_date_sk_5 == d_date_sk_16
                        │                                         │        ├─ Repartition Exchange Est. ? rows
                        │                                         │        │  │     Partition by: {cs_sold_date_sk_5}
                        │                                         │        │  └─ Inner Join Est. ? rows
                        │                                         │        │     │     Condition: cs_item_sk_3 == i_item_sk_13
                        │                                         │        │     ├─ Repartition Exchange Est. ? rows
                        │                                         │        │     │  │     Partition by: {cs_item_sk_3}
                        │                                         │        │     │  └─ TableScan tpcds.catalog_sales Est. ? rows
                        │                                         │        │     │           Outputs: cs_item_sk_3:=cs_item_sk, cs_sold_date_sk_5:=cs_sold_date_sk
                        │                                         │        │     └─ Repartition Exchange Est. ? rows
                        │                                         │        │        │     Partition by: {i_item_sk_13}
                        │                                         │        │        └─ TableScan tpcds.item Est. ? rows
                        │                                         │        │                 Outputs: i_brand_id_17:=i_brand_id, i_category_id_17:=i_category_id, i_class_id_17:=i_class_id, i_item_sk_13:=i_item_sk
                        │                                         │        └─ Repartition Exchange Est. ? rows
                        │                                         │           │     Partition by: {d_date_sk_16}
                        │                                         │           └─ Filter Est. ? rows
                        │                                         │              │     Condition: (d_year_16 >= 1999) AND (d_year_16 <= 2001)
                        │                                         │              └─ TableScan tpcds.date_dim Est. ? rows
                        │                                         │                       Where: (d_year >= 1999) AND (d_year <= 2001)
                        │                                         │                       Outputs: d_date_sk_16:=d_date_sk, d_year_16:=d_year
                        │                                         └─ Aggregating Est. ? rows
                        │                                            │     Group by: {i_brand_id_19, i_category_id_19, i_class_id_19}
                        │                                            │     Aggregates: count_6:=AggNull(sum)(marker_33), count_7:=AggNull(sum)(marker_34), count_8:=AggNull(sum)(marker_35)
                        │                                            └─ Projection Est. ? rows
                        │                                               │     Expressions: [i_brand_id_19, i_category_id_19, i_class_id_19], marker_33:=0, marker_34:=0, marker_35:=1
                        │                                               └─ Inner Join Est. ? rows
                        │                                                  │     Condition: ws_sold_date_sk_5 == d_date_sk_17
                        │                                                  ├─ Repartition Exchange Est. ? rows
                        │                                                  │  │     Partition by: {ws_sold_date_sk_5}
                        │                                                  │  └─ Inner Join Est. ? rows
                        │                                                  │     │     Condition: ws_item_sk_3 == i_item_sk_14
                        │                                                  │     ├─ Repartition Exchange Est. ? rows
                        │                                                  │     │  │     Partition by: {ws_item_sk_3}
                        │                                                  │     │  └─ TableScan tpcds.web_sales Est. ? rows
                        │                                                  │     │           Outputs: ws_item_sk_3:=ws_item_sk, ws_sold_date_sk_5:=ws_sold_date_sk
                        │                                                  │     └─ Repartition Exchange Est. ? rows
                        │                                                  │        │     Partition by: {i_item_sk_14}
                        │                                                  │        └─ TableScan tpcds.item Est. ? rows
                        │                                                  │                 Outputs: i_brand_id_19:=i_brand_id, i_category_id_19:=i_category_id, i_class_id_19:=i_class_id, i_item_sk_14:=i_item_sk
                        │                                                  └─ Repartition Exchange Est. ? rows
                        │                                                     │     Partition by: {d_date_sk_17}
                        │                                                     └─ Filter Est. ? rows
                        │                                                        │     Condition: (d_year_17 >= 1999) AND (d_year_17 <= 2001)
                        │                                                        └─ TableScan tpcds.date_dim Est. ? rows
                        │                                                                 Where: (d_year >= 1999) AND (d_year <= 2001)
                        │                                                                 Outputs: d_date_sk_17:=d_date_sk, d_year_17:=d_year
                        └─ Broadcast Exchange Est. ? rows
                           └─ MergingAggregated Est. ? rows
                              └─ Gather Exchange Est. ? rows
                                 └─ Aggregating Est. ? rows
                                    │     Group by: {}
                                    │     Aggregates: expr#avg(multiply(quantity, list_price))_2:=AggNull(avg)(expr#multiply(quantity, list_price)_2)
                                    └─ Projection Est. ? rows
                                       │     Expressions: expr#multiply(quantity, list_price)_2:=ss_quantity_6 * ss_list_price_6
                                       └─ Union Est. ? rows
                                          ├─ Inner Join Est. ? rows
                                          │  │     Condition: ss_sold_date_sk_6 == d_date_sk_18
                                          │  ├─ Repartition Exchange Est. ? rows
                                          │  │  │     Partition by: {ss_sold_date_sk_6}
                                          │  │  └─ TableScan tpcds.store_sales Est. ? rows
                                          │  │           Outputs: ss_list_price_5:=ss_list_price, ss_quantity_5:=ss_quantity, ss_sold_date_sk_6:=ss_sold_date_sk
                                          │  └─ Repartition Exchange Est. ? rows
                                          │     │     Partition by: {d_date_sk_18}
                                          │     └─ Filter Est. ? rows
                                          │        │     Condition: (d_year_18 >= 1999) AND (d_year_18 <= 2001)
                                          │        └─ TableScan tpcds.date_dim Est. ? rows
                                          │                 Where: (d_year >= 1999) AND (d_year <= 2001)
                                          │                 Outputs: d_date_sk_18:=d_date_sk, d_year_18:=d_year
                                          ├─ Inner Join Est. ? rows
                                          │  │     Condition: cs_sold_date_sk_6 == d_date_sk_19
                                          │  ├─ Repartition Exchange Est. ? rows
                                          │  │  │     Partition by: {cs_sold_date_sk_6}
                                          │  │  └─ TableScan tpcds.catalog_sales Est. ? rows
                                          │  │           Outputs: cs_list_price_3:=cs_list_price, cs_quantity_3:=cs_quantity, cs_sold_date_sk_6:=cs_sold_date_sk
                                          │  └─ Repartition Exchange Est. ? rows
                                          │     │     Partition by: {d_date_sk_19}
                                          │     └─ Filter Est. ? rows
                                          │        │     Condition: (d_year_19 >= 1999) AND (d_year_19 <= 2001)
                                          │        └─ TableScan tpcds.date_dim Est. ? rows
                                          │                 Where: (d_year >= 1999) AND (d_year <= 2001)
                                          │                 Outputs: d_date_sk_19:=d_date_sk, d_year_19:=d_year
                                          └─ Inner Join Est. ? rows
                                             │     Condition: ws_sold_date_sk_6 == d_date_sk_20
                                             ├─ Repartition Exchange Est. ? rows
                                             │  │     Partition by: {ws_sold_date_sk_6}
                                             │  └─ TableScan tpcds.web_sales Est. ? rows
                                             │           Outputs: ws_list_price_3:=ws_list_price, ws_quantity_3:=ws_quantity, ws_sold_date_sk_6:=ws_sold_date_sk
                                             └─ Repartition Exchange Est. ? rows
                                                │     Partition by: {d_date_sk_20}
                                                └─ Filter Est. ? rows
                                                   │     Condition: (d_year_20 >= 1999) AND (d_year_20 <= 2001)
                                                   └─ TableScan tpcds.date_dim Est. ? rows
                                                            Where: (d_year >= 1999) AND (d_year <= 2001)
                                                            Outputs: d_date_sk_20:=d_date_sk, d_year_20:=d_year
Projection Est. 100 rows
│     Expressions: ly_brand:=i_brand_id_29, ly_category:=i_category_id_29, ly_channel:=`expr#'store'_3`, ly_class:=i_class_id_29, ly_number_sales:=`expr#count()_5`, ly_sales:=`expr#sum(multiply(ss_quantity, ss_list_price))_3`, ty_brand:=i_brand_id_22, ty_category:=i_category_id_22, ty_channel:=`expr#'store'_2`, ty_class:=i_class_id_22, ty_number_sales:=`expr#count()_4`, ty_sales:=`expr#sum(multiply(ss_quantity, ss_list_price))_2`
└─ Limit Est. 100 rows
   │     Limit: 100
   └─ Sorting Est. 100 rows
      │     Order by: {expr#'store'_2 asc, i_brand_id_22 asc, i_class_id_22 asc, i_category_id_22 asc}
      │     Limit: 100
      └─ Gather Exchange Est. ? rows
         └─ Sorting Est. 100 rows
            │     Order by: {expr#'store'_2 asc, i_brand_id_22 asc, i_class_id_22 asc, i_category_id_22 asc}
            │     Limit: 100
            └─ Inner Join Est. ? rows
               │     Condition: i_brand_id_22 == i_brand_id_29, i_category_id_22 == i_category_id_29, i_class_id_22 == i_class_id_29
               ├─ Projection Est. ? rows
               │  │     Expressions: [expr#count()_4, expr#sum(multiply(ss_quantity, ss_list_price))_2, i_brand_id_22, i_category_id_22, i_class_id_22], expr#'store'_2:='store'
               │  └─ Inner Join Est. ? rows
               │     │     Condition: 
               │     │     Filter: `expr#sum(multiply(ss_quantity, ss_list_price))_2` > `expr#avg(multiply(quantity, list_price))_3`
               │     ├─ MergingAggregated Est. ? rows
               │     │  └─ Repartition Exchange Est. ? rows
               │     │     │     Partition by: {i_brand_id_22, i_category_id_22, i_class_id_22}
               │     │     └─ Aggregating Est. ? rows
               │     │        │     Group by: {i_brand_id_22, i_category_id_22, i_class_id_22}
               │     │        │     Aggregates: expr#sum(multiply(ss_quantity, ss_list_price))_2:=AggNull(sum)(expr#multiply(ss_quantity, ss_list_price)_1), expr#count()_4:=AggNull(count)()
               │     │        └─ Projection Est. ? rows
               │     │           │     Expressions: [i_brand_id_22, i_category_id_22, i_class_id_22], expr#multiply(ss_quantity, ss_list_price)_1:=ss_quantity_7 * ss_list_price_7
               │     │           └─ Inner Join Est. ? rows
               │     │              │     Condition: i_item_sk_15 == i_item_sk_16
               │     │              ├─ Repartition Exchange Est. ? rows
               │     │              │  │     Partition by: {i_item_sk_15}
               │     │              │  └─ Inner Join Est. ? rows
               │     │              │     │     Condition: ss_sold_date_sk_7 == d_date_sk_21
               │     │              │     ├─ Repartition Exchange Est. ? rows
               │     │              │     │  │     Partition by: {ss_sold_date_sk_7}
               │     │              │     │  └─ Inner Join Est. ? rows
               │     │              │     │     │     Condition: ss_item_sk_4 == i_item_sk_15
               │     │              │     │     ├─ Repartition Exchange Est. ? rows
               │     │              │     │     │  │     Partition by: {ss_item_sk_4}
               │     │              │     │     │  └─ Filter Est. ? rows
               │     │              │     │     │     │     Condition: isNotNull(ss_item_sk_4)
               │     │              │     │     │     └─ TableScan tpcds.store_sales Est. ? rows
               │     │              │     │     │              Where: isNotNull(ss_item_sk)
               │     │              │     │     │              Outputs: ss_item_sk_4:=ss_item_sk, ss_list_price_7:=ss_list_price, ss_quantity_7:=ss_quantity, ss_sold_date_sk_7:=ss_sold_date_sk
               │     │              │     │     └─ Repartition Exchange Est. ? rows
               │     │              │     │        │     Partition by: {i_item_sk_15}
               │     │              │     │        └─ Filter Est. ? rows
               │     │              │     │           │     Condition: isNotNull(i_item_sk_15)
               │     │              │     │           └─ TableScan tpcds.item Est. ? rows
               │     │              │     │                    Where: isNotNull(i_item_sk)
               │     │              │     │                    Outputs: i_brand_id_22:=i_brand_id, i_category_id_22:=i_category_id, i_class_id_22:=i_class_id, i_item_sk_15:=i_item_sk
               │     │              │     └─ Repartition Exchange Est. ? rows
               │     │              │        │     Partition by: {d_date_sk_21}
               │     │              │        └─ Inner Join Est. ? rows
               │     │              │           │     Condition: d_week_seq == d_week_seq_1
               │     │              │           ├─ Repartition Exchange Est. ? rows
               │     │              │           │  │     Partition by: {d_week_seq}
               │     │              │           │  └─ TableScan tpcds.date_dim Est. ? rows
               │     │              │           │           Outputs: [d_week_seq], d_date_sk_21:=d_date_sk
               │     │              │           └─ Repartition Exchange Est. ? rows
               │     │              │              │     Partition by: {d_week_seq_1}
               │     │              │              └─ EnforceSingleRow Est. ? rows
               │     │              │                 └─ Union Est. ? rows
               │     │              │                    └─ Gather Exchange Est. ? rows
               │     │              │                       └─ Projection Est. ? rows
               │     │              │                          │     Expressions: [d_week_seq_1]
               │     │              │                          └─ Filter Est. ? rows
               │     │              │                             │     Condition: (d_year_21 = 2000) AND (d_moy_3 = 12) AND (d_dom = 11)
               │     │              │                             └─ TableScan tpcds.date_dim Est. ? rows
               │     │              │                                      Where: (d_year = 2000) AND (d_moy = 12) AND (d_dom = 11)
               │     │              │                                      Outputs: [d_dom], d_moy_3:=d_moy, d_week_seq_1:=d_week_seq, d_year_21:=d_year
               │     │              └─ MergingAggregated Est. ? rows
               │     │                 └─ Repartition Exchange Est. ? rows
               │     │                    │     Partition by: {i_item_sk_16}
               │     │                    └─ Aggregating Est. ? rows
               │     │                       │     Group by: {i_item_sk_16}
               │     │                       └─ Inner Join Est. ? rows
               │     │                          │     Condition: i_brand_id_23 == i_brand_id_28, i_category_id_23 == i_category_id_28, i_class_id_23 == i_class_id_28
               │     │                          ├─ Repartition Exchange Est. ? rows
               │     │                          │  │     Partition by: {i_brand_id_23, i_category_id_23, i_class_id_23}
               │     │                          │  └─ Filter Est. ? rows
               │     │                          │     │     Condition: isNotNull(i_item_sk_16)
               │     │                          │     └─ TableScan tpcds.item Est. ? rows
               │     │                          │              Where: isNotNull(i_item_sk)
               │     │                          │              Outputs: i_brand_id_23:=i_brand_id, i_category_id_23:=i_category_id, i_class_id_23:=i_class_id, i_item_sk_16:=i_item_sk
               │     │                          └─ Repartition Exchange Est. ? rows
               │     │                             │     Partition by: {i_brand_id_28, i_category_id_28, i_class_id_28}
               │     │                             └─ Filter Est. ? rows
               │     │                                │     Condition: (count_9 >= 1) AND (count_10 >= 1) AND (count_11 >= 1)
               │     │                                └─ MergingAggregated Est. ? rows
               │     │                                   └─ Repartition Exchange Est. ? rows
               │     │                                      │     Partition by: {i_brand_id_28, i_category_id_28, i_class_id_28}
               │     │                                      └─ Union Est. ? rows
               │     │                                         ├─ Aggregating Est. ? rows
               │     │                                         │  │     Group by: {i_brand_id_24, i_category_id_24, i_class_id_24}
               │     │                                         │  │     Aggregates: count_9:=AggNull(sum)(marker_39), count_10:=AggNull(sum)(marker_40), count_11:=AggNull(sum)(marker_41)
               │     │                                         │  └─ Projection Est. ? rows
               │     │                                         │     │     Expressions: [i_brand_id_24, i_category_id_24, i_class_id_24], marker_39:=1, marker_40:=0, marker_41:=0
               │     │                                         │     └─ Inner Join Est. ? rows
               │     │                                         │        │     Condition: ss_sold_date_sk_8 == d_date_sk_22
               │     │                                         │        ├─ Repartition Exchange Est. ? rows
               │     │                                         │        │  │     Partition by: {ss_sold_date_sk_8}
               │     │                                         │        │  └─ Inner Join Est. ? rows
               │     │                                         │        │     │     Condition: ss_item_sk_5 == i_item_sk_17
               │     │                                         │        │     ├─ Repartition Exchange Est. ? rows
               │     │                                         │        │     │  │     Partition by: {ss_item_sk_5}
               │     │                                         │        │     │  └─ TableScan tpcds.store_sales Est. ? rows
               │     │                                         │        │     │           Outputs: ss_item_sk_5:=ss_item_sk, ss_sold_date_sk_8:=ss_sold_date_sk
               │     │                                         │        │     └─ Repartition Exchange Est. ? rows
               │     │                                         │        │        │     Partition by: {i_item_sk_17}
               │     │                                         │        │        └─ TableScan tpcds.item Est. ? rows
               │     │                                         │        │                 Outputs: i_brand_id_24:=i_brand_id, i_category_id_24:=i_category_id, i_class_id_24:=i_class_id, i_item_sk_17:=i_item_sk
               │     │                                         │        └─ Repartition Exchange Est. ? rows
               │     │                                         │           │     Partition by: {d_date_sk_22}
               │     │                                         │           └─ Filter Est. ? rows
               │     │                                         │              │     Condition: (d_year_22 >= 1999) AND (d_year_22 <= 2001)
               │     │                                         │              └─ TableScan tpcds.date_dim Est. ? rows
               │     │                                         │                       Where: (d_year >= 1999) AND (d_year <= 2001)
               │     │                                         │                       Outputs: d_date_sk_22:=d_date_sk, d_year_22:=d_year
               │     │                                         ├─ Aggregating Est. ? rows
               │     │                                         │  │     Group by: {i_brand_id_25, i_category_id_25, i_class_id_25}
               │     │                                         │  │     Aggregates: count_9:=AggNull(sum)(marker_42), count_10:=AggNull(sum)(marker_43), count_11:=AggNull(sum)(marker_44)
               │     │                                         │  └─ Projection Est. ? rows
               │     │                                         │     │     Expressions: [i_brand_id_25, i_category_id_25, i_class_id_25], marker_42:=0, marker_43:=1, marker_44:=0
               │     │                                         │     └─ Inner Join Est. ? rows
               │     │                                         │        │     Condition: cs_sold_date_sk_7 == d_date_sk_23
               │     │                                         │        ├─ Repartition Exchange Est. ? rows
               │     │                                         │        │  │     Partition by: {cs_sold_date_sk_7}
               │     │                                         │        │  └─ Inner Join Est. ? rows
               │     │                                         │        │     │     Condition: cs_item_sk_4 == i_item_sk_18
               │     │                                         │        │     ├─ Repartition Exchange Est. ? rows
               │     │                                         │        │     │  │     Partition by: {cs_item_sk_4}
               │     │                                         │        │     │  └─ TableScan tpcds.catalog_sales Est. ? rows
               │     │                                         │        │     │           Outputs: cs_item_sk_4:=cs_item_sk, cs_sold_date_sk_7:=cs_sold_date_sk
               │     │                                         │        │     └─ Repartition Exchange Est. ? rows
               │     │                                         │        │        │     Partition by: {i_item_sk_18}
               │     │                                         │        │        └─ TableScan tpcds.item Est. ? rows
               │     │                                         │        │                 Outputs: i_brand_id_25:=i_brand_id, i_category_id_25:=i_category_id, i_class_id_25:=i_class_id, i_item_sk_18:=i_item_sk
               │     │                                         │        └─ Repartition Exchange Est. ? rows
               │     │                                         │           │     Partition by: {d_date_sk_23}
               │     │                                         │           └─ Filter Est. ? rows
               │     │                                         │              │     Condition: (d_year_23 >= 1999) AND (d_year_23 <= 2001)
               │     │                                         │              └─ TableScan tpcds.date_dim Est. ? rows
               │     │                                         │                       Where: (d_year >= 1999) AND (d_year <= 2001)
               │     │                                         │                       Outputs: d_date_sk_23:=d_date_sk, d_year_23:=d_year
               │     │                                         └─ Aggregating Est. ? rows
               │     │                                            │     Group by: {i_brand_id_27, i_category_id_27, i_class_id_27}
               │     │                                            │     Aggregates: count_9:=AggNull(sum)(marker_45), count_10:=AggNull(sum)(marker_46), count_11:=AggNull(sum)(marker_47)
               │     │                                            └─ Projection Est. ? rows
               │     │                                               │     Expressions: [i_brand_id_27, i_category_id_27, i_class_id_27], marker_45:=0, marker_46:=0, marker_47:=1
               │     │                                               └─ Inner Join Est. ? rows
               │     │                                                  │     Condition: ws_sold_date_sk_7 == d_date_sk_24
               │     │                                                  ├─ Repartition Exchange Est. ? rows
               │     │                                                  │  │     Partition by: {ws_sold_date_sk_7}
               │     │                                                  │  └─ Inner Join Est. ? rows
               │     │                                                  │     │     Condition: ws_item_sk_4 == i_item_sk_19
               │     │                                                  │     ├─ Repartition Exchange Est. ? rows
               │     │                                                  │     │  │     Partition by: {ws_item_sk_4}
               │     │                                                  │     │  └─ TableScan tpcds.web_sales Est. ? rows
               │     │                                                  │     │           Outputs: ws_item_sk_4:=ws_item_sk, ws_sold_date_sk_7:=ws_sold_date_sk
               │     │                                                  │     └─ Repartition Exchange Est. ? rows
               │     │                                                  │        │     Partition by: {i_item_sk_19}
               │     │                                                  │        └─ TableScan tpcds.item Est. ? rows
               │     │                                                  │                 Outputs: i_brand_id_27:=i_brand_id, i_category_id_27:=i_category_id, i_class_id_27:=i_class_id, i_item_sk_19:=i_item_sk
               │     │                                                  └─ Repartition Exchange Est. ? rows
               │     │                                                     │     Partition by: {d_date_sk_24}
               │     │                                                     └─ Filter Est. ? rows
               │     │                                                        │     Condition: (d_year_24 >= 1999) AND (d_year_24 <= 2001)
               │     │                                                        └─ TableScan tpcds.date_dim Est. ? rows
               │     │                                                                 Where: (d_year >= 1999) AND (d_year <= 2001)
               │     │                                                                 Outputs: d_date_sk_24:=d_date_sk, d_year_24:=d_year
               │     └─ Broadcast Exchange Est. ? rows
               │        └─ MergingAggregated Est. ? rows
               │           └─ Gather Exchange Est. ? rows
               │              └─ Aggregating Est. ? rows
               │                 │     Group by: {}
               │                 │     Aggregates: expr#avg(multiply(quantity, list_price))_3:=AggNull(avg)(expr#multiply(quantity, list_price)_3)
               │                 └─ Projection Est. ? rows
               │                    │     Expressions: expr#multiply(quantity, list_price)_3:=ss_quantity_9 * ss_list_price_9
               │                    └─ Union Est. ? rows
               │                       ├─ Inner Join Est. ? rows
               │                       │  │     Condition: ss_sold_date_sk_9 == d_date_sk_25
               │                       │  ├─ Repartition Exchange Est. ? rows
               │                       │  │  │     Partition by: {ss_sold_date_sk_9}
               │                       │  │  └─ TableScan tpcds.store_sales Est. ? rows
               │                       │  │           Outputs: ss_list_price_8:=ss_list_price, ss_quantity_8:=ss_quantity, ss_sold_date_sk_9:=ss_sold_date_sk
               │                       │  └─ Repartition Exchange Est. ? rows
               │                       │     │     Partition by: {d_date_sk_25}
               │                       │     └─ Filter Est. ? rows
               │                       │        │     Condition: (d_year_25 >= 1999) AND (d_year_25 <= 2001)
               │                       │        └─ TableScan tpcds.date_dim Est. ? rows
               │                       │                 Where: (d_year >= 1999) AND (d_year <= 2001)
               │                       │                 Outputs: d_date_sk_25:=d_date_sk, d_year_25:=d_year
               │                       ├─ Inner Join Est. ? rows
               │                       │  │     Condition: cs_sold_date_sk_8 == d_date_sk_26
               │                       │  ├─ Repartition Exchange Est. ? rows
               │                       │  │  │     Partition by: {cs_sold_date_sk_8}
               │                       │  │  └─ TableScan tpcds.catalog_sales Est. ? rows
               │                       │  │           Outputs: cs_list_price_4:=cs_list_price, cs_quantity_4:=cs_quantity, cs_sold_date_sk_8:=cs_sold_date_sk
               │                       │  └─ Repartition Exchange Est. ? rows
               │                       │     │     Partition by: {d_date_sk_26}
               │                       │     └─ Filter Est. ? rows
               │                       │        │     Condition: (d_year_26 >= 1999) AND (d_year_26 <= 2001)
               │                       │        └─ TableScan tpcds.date_dim Est. ? rows
               │                       │                 Where: (d_year >= 1999) AND (d_year <= 2001)
               │                       │                 Outputs: d_date_sk_26:=d_date_sk, d_year_26:=d_year
               │                       └─ Inner Join Est. ? rows
               │                          │     Condition: ws_sold_date_sk_8 == d_date_sk_27
               │                          ├─ Repartition Exchange Est. ? rows
               │                          │  │     Partition by: {ws_sold_date_sk_8}
               │                          │  └─ TableScan tpcds.web_sales Est. ? rows
               │                          │           Outputs: ws_list_price_4:=ws_list_price, ws_quantity_4:=ws_quantity, ws_sold_date_sk_8:=ws_sold_date_sk
               │                          └─ Repartition Exchange Est. ? rows
               │                             │     Partition by: {d_date_sk_27}
               │                             └─ Filter Est. ? rows
               │                                │     Condition: (d_year_27 >= 1999) AND (d_year_27 <= 2001)
               │                                └─ TableScan tpcds.date_dim Est. ? rows
               │                                         Where: (d_year >= 1999) AND (d_year <= 2001)
               │                                         Outputs: d_date_sk_27:=d_date_sk, d_year_27:=d_year
               └─ Projection Est. ? rows
                  │     Expressions: [expr#count()_5, expr#sum(multiply(ss_quantity, ss_list_price))_3, i_brand_id_29, i_category_id_29, i_class_id_29], expr#'store'_3:='store'
                  └─ Inner Join Est. ? rows
                     │     Condition: 
                     │     Filter: `expr#sum(multiply(ss_quantity, ss_list_price))_3` > `expr#avg(multiply(quantity, list_price))_4`
                     ├─ MergingAggregated Est. ? rows
                     │  └─ Repartition Exchange Est. ? rows
                     │     │     Partition by: {i_brand_id_29, i_category_id_29, i_class_id_29}
                     │     └─ Aggregating Est. ? rows
                     │        │     Group by: {i_brand_id_29, i_category_id_29, i_class_id_29}
                     │        │     Aggregates: expr#sum(multiply(ss_quantity, ss_list_price))_3:=AggNull(sum)(expr#multiply(ss_quantity, ss_list_price)_2), expr#count()_5:=AggNull(count)()
                     │        └─ Projection Est. ? rows
                     │           │     Expressions: [i_brand_id_29, i_category_id_29, i_class_id_29], expr#multiply(ss_quantity, ss_list_price)_2:=ss_quantity_10 * ss_list_price_10
                     │           └─ Inner Join Est. ? rows
                     │              │     Condition: i_item_sk_20 == i_item_sk_21
                     │              ├─ Repartition Exchange Est. ? rows
                     │              │  │     Partition by: {i_item_sk_20}
                     │              │  └─ Inner Join Est. ? rows
                     │              │     │     Condition: ss_sold_date_sk_10 == d_date_sk_28
                     │              │     ├─ Repartition Exchange Est. ? rows
                     │              │     │  │     Partition by: {ss_sold_date_sk_10}
                     │              │     │  └─ Inner Join Est. ? rows
                     │              │     │     │     Condition: ss_item_sk_6 == i_item_sk_20
                     │              │     │     ├─ Repartition Exchange Est. ? rows
                     │              │     │     │  │     Partition by: {ss_item_sk_6}
                     │              │     │     │  └─ Filter Est. ? rows
                     │              │     │     │     │     Condition: isNotNull(ss_item_sk_6)
                     │              │     │     │     └─ TableScan tpcds.store_sales Est. ? rows
                     │              │     │     │              Where: isNotNull(ss_item_sk)
                     │              │     │     │              Outputs: ss_item_sk_6:=ss_item_sk, ss_list_price_10:=ss_list_price, ss_quantity_10:=ss_quantity, ss_sold_date_sk_10:=ss_sold_date_sk
                     │              │     │     └─ Repartition Exchange Est. ? rows
                     │              │     │        │     Partition by: {i_item_sk_20}
                     │              │     │        └─ Filter Est. ? rows
                     │              │     │           │     Condition: isNotNull(i_item_sk_20)
                     │              │     │           └─ TableScan tpcds.item Est. ? rows
                     │              │     │                    Where: isNotNull(i_item_sk)
                     │              │     │                    Outputs: i_brand_id_29:=i_brand_id, i_category_id_29:=i_category_id, i_class_id_29:=i_class_id, i_item_sk_20:=i_item_sk
                     │              │     └─ Repartition Exchange Est. ? rows
                     │              │        │     Partition by: {d_date_sk_28}
                     │              │        └─ Inner Join Est. ? rows
                     │              │           │     Condition: d_week_seq_2 == d_week_seq_3
                     │              │           ├─ Repartition Exchange Est. ? rows
                     │              │           │  │     Partition by: {d_week_seq_2}
                     │              │           │  └─ TableScan tpcds.date_dim Est. ? rows
                     │              │           │           Outputs: d_date_sk_28:=d_date_sk, d_week_seq_2:=d_week_seq
                     │              │           └─ Repartition Exchange Est. ? rows
                     │              │              │     Partition by: {d_week_seq_3}
                     │              │              └─ EnforceSingleRow Est. ? rows
                     │              │                 └─ Union Est. ? rows
                     │              │                    └─ Gather Exchange Est. ? rows
                     │              │                       └─ Projection Est. ? rows
                     │              │                          │     Expressions: [d_week_seq_3]
                     │              │                          └─ Filter Est. ? rows
                     │              │                             │     Condition: (d_year_28 = 1999) AND (d_moy_4 = 12) AND (d_dom_1 = 11)
                     │              │                             └─ TableScan tpcds.date_dim Est. ? rows
                     │              │                                      Where: (d_year = 1999) AND (d_moy = 12) AND (d_dom = 11)
                     │              │                                      Outputs: d_dom_1:=d_dom, d_moy_4:=d_moy, d_week_seq_3:=d_week_seq, d_year_28:=d_year
                     │              └─ MergingAggregated Est. ? rows
                     │                 └─ Repartition Exchange Est. ? rows
                     │                    │     Partition by: {i_item_sk_21}
                     │                    └─ Aggregating Est. ? rows
                     │                       │     Group by: {i_item_sk_21}
                     │                       └─ Inner Join Est. ? rows
                     │                          │     Condition: i_brand_id_30 == i_brand_id_35, i_category_id_30 == i_category_id_35, i_class_id_30 == i_class_id_35
                     │                          ├─ Repartition Exchange Est. ? rows
                     │                          │  │     Partition by: {i_brand_id_30, i_category_id_30, i_class_id_30}
                     │                          │  └─ Filter Est. ? rows
                     │                          │     │     Condition: isNotNull(i_item_sk_21)
                     │                          │     └─ TableScan tpcds.item Est. ? rows
                     │                          │              Where: isNotNull(i_item_sk)
                     │                          │              Outputs: i_brand_id_30:=i_brand_id, i_category_id_30:=i_category_id, i_class_id_30:=i_class_id, i_item_sk_21:=i_item_sk
                     │                          └─ Repartition Exchange Est. ? rows
                     │                             │     Partition by: {i_brand_id_35, i_category_id_35, i_class_id_35}
                     │                             └─ Filter Est. ? rows
                     │                                │     Condition: (count_12 >= 1) AND (count_13 >= 1) AND (count_14 >= 1)
                     │                                └─ MergingAggregated Est. ? rows
                     │                                   └─ Repartition Exchange Est. ? rows
                     │                                      │     Partition by: {i_brand_id_35, i_category_id_35, i_class_id_35}
                     │                                      └─ Union Est. ? rows
                     │                                         ├─ Aggregating Est. ? rows
                     │                                         │  │     Group by: {i_brand_id_31, i_category_id_31, i_class_id_31}
                     │                                         │  │     Aggregates: count_12:=AggNull(sum)(marker_51), count_13:=AggNull(sum)(marker_52), count_14:=AggNull(sum)(marker_53)
                     │                                         │  └─ Projection Est. ? rows
                     │                                         │     │     Expressions: [i_brand_id_31, i_category_id_31, i_class_id_31], marker_51:=1, marker_52:=0, marker_53:=0
                     │                                         │     └─ Inner Join Est. ? rows
                     │                                         │        │     Condition: ss_sold_date_sk_11 == d_date_sk_29
                     │                                         │        ├─ Repartition Exchange Est. ? rows
                     │                                         │        │  │     Partition by: {ss_sold_date_sk_11}
                     │                                         │        │  └─ Inner Join Est. ? rows
                     │                                         │        │     │     Condition: ss_item_sk_7 == i_item_sk_22
                     │                                         │        │     ├─ Repartition Exchange Est. ? rows
                     │                                         │        │     │  │     Partition by: {ss_item_sk_7}
                     │                                         │        │     │  └─ TableScan tpcds.store_sales Est. ? rows
                     │                                         │        │     │           Outputs: ss_item_sk_7:=ss_item_sk, ss_sold_date_sk_11:=ss_sold_date_sk
                     │                                         │        │     └─ Repartition Exchange Est. ? rows
                     │                                         │        │        │     Partition by: {i_item_sk_22}
                     │                                         │        │        └─ TableScan tpcds.item Est. ? rows
                     │                                         │        │                 Outputs: i_brand_id_31:=i_brand_id, i_category_id_31:=i_category_id, i_class_id_31:=i_class_id, i_item_sk_22:=i_item_sk
                     │                                         │        └─ Repartition Exchange Est. ? rows
                     │                                         │           │     Partition by: {d_date_sk_29}
                     │                                         │           └─ Filter Est. ? rows
                     │                                         │              │     Condition: (d_year_29 >= 1999) AND (d_year_29 <= 2001)
                     │                                         │              └─ TableScan tpcds.date_dim Est. ? rows
                     │                                         │                       Where: (d_year >= 1999) AND (d_year <= 2001)
                     │                                         │                       Outputs: d_date_sk_29:=d_date_sk, d_year_29:=d_year
                     │                                         ├─ Aggregating Est. ? rows
                     │                                         │  │     Group by: {i_brand_id_32, i_category_id_32, i_class_id_32}
                     │                                         │  │     Aggregates: count_12:=AggNull(sum)(marker_54), count_13:=AggNull(sum)(marker_55), count_14:=AggNull(sum)(marker_56)
                     │                                         │  └─ Projection Est. ? rows
                     │                                         │     │     Expressions: [i_brand_id_32, i_category_id_32, i_class_id_32], marker_54:=0, marker_55:=1, marker_56:=0
                     │                                         │     └─ Inner Join Est. ? rows
                     │                                         │        │     Condition: cs_sold_date_sk_9 == d_date_sk_30
                     │                                         │        ├─ Repartition Exchange Est. ? rows
                     │                                         │        │  │     Partition by: {cs_sold_date_sk_9}
                     │                                         │        │  └─ Inner Join Est. ? rows
                     │                                         │        │     │     Condition: cs_item_sk_5 == i_item_sk_23
                     │                                         │        │     ├─ Repartition Exchange Est. ? rows
                     │                                         │        │     │  │     Partition by: {cs_item_sk_5}
                     │                                         │        │     │  └─ TableScan tpcds.catalog_sales Est. ? rows
                     │                                         │        │     │           Outputs: cs_item_sk_5:=cs_item_sk, cs_sold_date_sk_9:=cs_sold_date_sk
                     │                                         │        │     └─ Repartition Exchange Est. ? rows
                     │                                         │        │        │     Partition by: {i_item_sk_23}
                     │                                         │        │        └─ TableScan tpcds.item Est. ? rows
                     │                                         │        │                 Outputs: i_brand_id_32:=i_brand_id, i_category_id_32:=i_category_id, i_class_id_32:=i_class_id, i_item_sk_23:=i_item_sk
                     │                                         │        └─ Repartition Exchange Est. ? rows
                     │                                         │           │     Partition by: {d_date_sk_30}
                     │                                         │           └─ Filter Est. ? rows
                     │                                         │              │     Condition: (d_year_30 >= 1999) AND (d_year_30 <= 2001)
                     │                                         │              └─ TableScan tpcds.date_dim Est. ? rows
                     │                                         │                       Where: (d_year >= 1999) AND (d_year <= 2001)
                     │                                         │                       Outputs: d_date_sk_30:=d_date_sk, d_year_30:=d_year
                     │                                         └─ Aggregating Est. ? rows
                     │                                            │     Group by: {i_brand_id_34, i_category_id_34, i_class_id_34}
                     │                                            │     Aggregates: count_12:=AggNull(sum)(marker_57), count_13:=AggNull(sum)(marker_58), count_14:=AggNull(sum)(marker_59)
                     │                                            └─ Projection Est. ? rows
                     │                                               │     Expressions: [i_brand_id_34, i_category_id_34, i_class_id_34], marker_57:=0, marker_58:=0, marker_59:=1
                     │                                               └─ Inner Join Est. ? rows
                     │                                                  │     Condition: ws_sold_date_sk_9 == d_date_sk_31
                     │                                                  ├─ Repartition Exchange Est. ? rows
                     │                                                  │  │     Partition by: {ws_sold_date_sk_9}
                     │                                                  │  └─ Inner Join Est. ? rows
                     │                                                  │     │     Condition: ws_item_sk_5 == i_item_sk_24
                     │                                                  │     ├─ Repartition Exchange Est. ? rows
                     │                                                  │     │  │     Partition by: {ws_item_sk_5}
                     │                                                  │     │  └─ TableScan tpcds.web_sales Est. ? rows
                     │                                                  │     │           Outputs: ws_item_sk_5:=ws_item_sk, ws_sold_date_sk_9:=ws_sold_date_sk
                     │                                                  │     └─ Repartition Exchange Est. ? rows
                     │                                                  │        │     Partition by: {i_item_sk_24}
                     │                                                  │        └─ TableScan tpcds.item Est. ? rows
                     │                                                  │                 Outputs: i_brand_id_34:=i_brand_id, i_category_id_34:=i_category_id, i_class_id_34:=i_class_id, i_item_sk_24:=i_item_sk
                     │                                                  └─ Repartition Exchange Est. ? rows
                     │                                                     │     Partition by: {d_date_sk_31}
                     │                                                     └─ Filter Est. ? rows
                     │                                                        │     Condition: (d_year_31 >= 1999) AND (d_year_31 <= 2001)
                     │                                                        └─ TableScan tpcds.date_dim Est. ? rows
                     │                                                                 Where: (d_year >= 1999) AND (d_year <= 2001)
                     │                                                                 Outputs: d_date_sk_31:=d_date_sk, d_year_31:=d_year
                     └─ Broadcast Exchange Est. ? rows
                        └─ MergingAggregated Est. ? rows
                           └─ Gather Exchange Est. ? rows
                              └─ Aggregating Est. ? rows
                                 │     Group by: {}
                                 │     Aggregates: expr#avg(multiply(quantity, list_price))_4:=AggNull(avg)(expr#multiply(quantity, list_price)_4)
                                 └─ Projection Est. ? rows
                                    │     Expressions: expr#multiply(quantity, list_price)_4:=ss_quantity_12 * ss_list_price_12
                                    └─ Union Est. ? rows
                                       ├─ Inner Join Est. ? rows
                                       │  │     Condition: ss_sold_date_sk_12 == d_date_sk_32
                                       │  ├─ Repartition Exchange Est. ? rows
                                       │  │  │     Partition by: {ss_sold_date_sk_12}
                                       │  │  └─ TableScan tpcds.store_sales Est. ? rows
                                       │  │           Outputs: ss_list_price_11:=ss_list_price, ss_quantity_11:=ss_quantity, ss_sold_date_sk_12:=ss_sold_date_sk
                                       │  └─ Repartition Exchange Est. ? rows
                                       │     │     Partition by: {d_date_sk_32}
                                       │     └─ Filter Est. ? rows
                                       │        │     Condition: (d_year_32 >= 1999) AND (d_year_32 <= 2001)
                                       │        └─ TableScan tpcds.date_dim Est. ? rows
                                       │                 Where: (d_year >= 1999) AND (d_year <= 2001)
                                       │                 Outputs: d_date_sk_32:=d_date_sk, d_year_32:=d_year
                                       ├─ Inner Join Est. ? rows
                                       │  │     Condition: cs_sold_date_sk_10 == d_date_sk_33
                                       │  ├─ Repartition Exchange Est. ? rows
                                       │  │  │     Partition by: {cs_sold_date_sk_10}
                                       │  │  └─ TableScan tpcds.catalog_sales Est. ? rows
                                       │  │           Outputs: cs_list_price_5:=cs_list_price, cs_quantity_5:=cs_quantity, cs_sold_date_sk_10:=cs_sold_date_sk
                                       │  └─ Repartition Exchange Est. ? rows
                                       │     │     Partition by: {d_date_sk_33}
                                       │     └─ Filter Est. ? rows
                                       │        │     Condition: (d_year_33 >= 1999) AND (d_year_33 <= 2001)
                                       │        └─ TableScan tpcds.date_dim Est. ? rows
                                       │                 Where: (d_year >= 1999) AND (d_year <= 2001)
                                       │                 Outputs: d_date_sk_33:=d_date_sk, d_year_33:=d_year
                                       └─ Inner Join Est. ? rows
                                          │     Condition: ws_sold_date_sk_10 == d_date_sk_34
                                          ├─ Repartition Exchange Est. ? rows
                                          │  │     Partition by: {ws_sold_date_sk_10}
                                          │  └─ TableScan tpcds.web_sales Est. ? rows
                                          │           Outputs: ws_list_price_5:=ws_list_price, ws_quantity_5:=ws_quantity, ws_sold_date_sk_10:=ws_sold_date_sk
                                          └─ Repartition Exchange Est. ? rows
                                             │     Partition by: {d_date_sk_34}
                                             └─ Filter Est. ? rows
                                                │     Condition: (d_year_34 >= 1999) AND (d_year_34 <= 2001)
                                                └─ TableScan tpcds.date_dim Est. ? rows
                                                         Where: (d_year >= 1999) AND (d_year <= 2001)
                                                         Outputs: d_date_sk_34:=d_date_sk, d_year_34:=d_year
